weighted.mean(fenoxLT, LT) # LT NOx
?`matrix-class`
?matrix`
?matrix
matrix(data = a, nrow = 3, ncol = 12)
a <- 1:12  #numeric vector
matrix(data = a, nrow = 3, ncol = 12)
matrix(data = a, nrow = 3, ncol = 4)
dim(m)
(m <- matrix(data = a, nrow = 3, ncol = 4))
dim(m)
?array
a <- array(data = a, dim = c(3,4,2))
(a <- array(data = a, dim = c(3,4,2)))
(a <- array(data = a, dim = c(3,4,1)))
m[1, 1] #first element
m[, 1]
m[1,1]  # firs row
m[1, ]  # firs row
m[3,4]
v1 <- 1:3
v2 <- c(1, 2, 3)
?length
a
(a <- array(data = a, dim = c(3,4,2)))
a[,,1]
a[,,1]
a[1,1,1] #first matrix
dims(a)
dim(a)
a[3, 4, 2]   # first matrix
n <- c(1, NA)
is.na(n)
n <- c(1, NaN)
is.na(n)
is.nan(n)
print(citation("data-table"), bibstyle = T)
print(citation("datatable"), bibstyle = T)
citation("data-table")
library(Data-table)
library(data-table)
library(datatable)
library(data.table)
print(citation("data.table"), bibstyle = T)
?data.table
library(dplyr)
?dplyr
print(citation("dplyr"), bibstyle = T)
library(read_xl)
library(readxl)
print(citation("readxl"), bibstyle = T)
print(citation("todyr"), bibstyle = T)
print(citation("tidyr"), bibstyle = T)
df <- data.frame(1:3, 4:6)
df
data.matrix(df)
as.matrix(df)
?data-frame
?data.frame
LETTERS
letters
ab <- data.frame(a,b)
a <- 1:3
b <- 3:6
ab <- data.frame(a,b)
b
b <- 3:5
ab <- data.frame(a,b)
ab
name = file.path(tempdir(), "YourCity")
inventory(name = name, show.dir = TRUE, show.scripts = TRUE)
library(vein)
library(emissV)
library(emissV)
library(EmissV)
library(EmissV)
?areaSource
shape  <- raster::shapefile(paste(system.file("extdata", package = "EmissV"),
"/BR.shp",sep=""),verbose = F)
shape  <- shape[22,1] # subset for Sao Paulo - BR
raster <- raster::raster(paste(system.file("extdata", package = "EmissV"),
"/sample.tiff",sep=""))
grid   <- gridInfo(paste(system.file("extdata", package = "EmissV"),"/wrfinput_d02",sep=""))
SP     <- areaSource(shape,raster,grid,name = "SPMA")
shape
raster
grid
class(SP)
plot(SP)
library(sp)
plot(SP)
spplot(SP)
emissionFactor
?emissionFactor
EF <- emissionFactor(ef = list(CO = c(1.75,10.04,0.39,0.45,0.77,1.48,1.61,0.75),
PM = c(0.0013,0.0,0.0010,0.0612,0.1052,0.1693,0.0,0.0)),
vnames = c("Light duty Vehicles Gasohol","Light Duty Vehicles Ethanol",
"Light Duty Vehicles Flex","Diesel trucks","Diesel urban busses",
"Diesel intercity busses","Gasohol motorcycles",
"Flex motorcycles"))
EF
emissionFactor(T)
emissionFactor(example = T)
?emission
veiculos <- vehicles(example = T)
EmissionFactors <- emissionFactor(example = T)
TOTAL  <- totalEmission(veiculos,EmissionFactors,pol = c("CO"),verbose = T)
grid   <- gridInfo(paste0(system.file("extdata", package = "EmissV"),"/wrfinput_d01"))
shape  <- raster::shapefile(paste0(system.file("extdata", package = "EmissV"),"/BR.shp"))
raster <- raster::raster(paste0(system.file("extdata", package = "EmissV"),"/sample.tiff"))
SP     <- areaSource(shape[22,1],raster,grid,name = "SP")
RJ     <- areaSource(shape[17,1],raster,grid,name = "RJ")
MG     <- areaSource(shape[12,1],raster,grid,name = "MG")
e_CO   <- emission(TOTAL,"CO",list(SP = SP, RJ = RJ, MG = MG),grid,mm=28)
class(e_CO)
dim(e_CO)
mode(e_CO)
e_CO
type(e_CO)
mode(e_CO)
str(e_CO)
class(e_CO)
image(e_CO)
image(as.numeric(e_CO))
matrix(as.numeric(e_CO), row = )
dim(e_CO)
matrix(as.numeric(e_CO), nrow = 99, ncol = 93)
image(matrix(as.numeric(e_CO), nrow = 99, ncol = 93))
?plumeRise
?pointSource
pointSource
vein::EmissionFactors(1:20)
vein::EmissionFactors(data.frame(a = 1:5, b = 5:6))
vein::EmissionFactors(data.frame(a = 1:5, b = 1:5))
ad <- vein::EmissionFactors(data.frame(a = 1:5, b = 1:5))
class(ad)
ad
as.data.frame(ad)
ef1 <- data.frame(CO = c(1.75,10.04,0.39,0.45,0.77,1.48,1.61,0.75), PM = c(0.0013,0.0,0.0010,0.0612,0.1052,0.1693,0.0,0.0))
EF <- emissionFactor(ef = list(CO = c(1.75,10.04,0.39,0.45,0.77,1.48,1.61,0.75),
PM = c(0.0013,0.0,0.0010,0.0612,0.1052,0.1693,0.0,0.0)),
vnames = c("Light duty Vehicles Gasohol","Light Duty Vehicles Ethanol",
"Light Duty Vehicles Flex","Diesel trucks","Diesel urban busses",
"Diesel intercity busses","Gasohol motorcycles",
"Flex motorcycles"))
EF
EmissionFactors
vein::EmissionFactors(ef1)
class(vein::EmissionFactors(ef1))
class(as.data.frame(vein::EmissionFactors(ef1)))
as.data.frame(vein::EmissionFactors(ef1))
ef1
EF <- emissionFactor(ef = list(CO = c(1.75,10.04,0.39,0.45,0.77,1.48,1.61,0.75),
+                                PM = c(0.0013,0.0,0.0010,0.0612,0.1052,0.1693,0.0,0.0)),
+                      vnames = c("Light duty Vehicles Gasohol","Light Duty Vehicles Ethanol",
+                                 "Light Duty Vehicles Flex","Diesel trucks","Diesel urban busses",
+                                 "Diesel intercity busses","Gasohol motorcycles",
+                                 "Flex motorcycles"))ef1_cla
ef1_cass <- vein::EmissionFactors(ef1)
ef1_class
ef1_class <- vein::EmissionFactors(ef1)
ef1_class
EF <- emissionFactor(ef = as.list(ef1_class),
vnames = c("Light duty Vehicles Gasohol","Light Duty Vehicles Ethanol",
"Light Duty Vehicles Flex","Diesel trucks","Diesel urban busses",
"Diesel intercity busses","Gasohol motorcycles",
"Flex motorcycles"))
as.list(ef1_class)
install.packages("googleway")
install.packages("jqr")
install.packages("googleway")
args(vein::emis_evap)
data(net)
PC_G <- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
133833,138441,142682,171029,151048,115228,98664,126444,101027,
84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh <- data.frame(PC_G = PC_G)
pc1 <- my_age(x = net$ldv, y = PC_G, name = "PC")
ef1 <- ef_evap(ef = "erhotc",v = "PC", cc = "<=1400", dt = "0_15", ca = "no")
dfe <- emis_evap(veh = pc1,
library(vein)
library(vein)
data(net)
PC_G <- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
133833,138441,142682,171029,151048,115228,98664,126444,101027,
84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh <- data.frame(PC_G = PC_G)
pc1 <- my_age(x = net$ldv, y = PC_G, name = "PC")
ef1 <- ef_evap(ef = "erhotc",v = "PC", cc = "<=1400", dt = "0_15", ca = "no")
dfe <- emis_evap(veh = pc1,
name = "PC",
size = "<=1400",
fuel = "G",
aged = 1:ncol(pc1),
nd4 = 10,
nd3 = 4,
nd2 = 2,
nd1 = 1,
hs_nd4 = ef1*1:ncol(pc1),
hs_nd3 = ef1*1:ncol(pc1),
hs_nd2 = ef1*1:ncol(pc1),
hs_nd1 = ef1*1:ncol(pc1),
d_nd4 = ef1*1:ncol(pc1),
d_nd3 = ef1*1:ncol(pc1),
d_nd2 = ef1*1:ncol(pc1),
d_nd1 = ef1*1:ncol(pc1),
rl_nd4 = ef1*1:ncol(pc1),
rl_nd3 = ef1*1:ncol(pc1),
rl_nd2 = ef1*1:ncol(pc1),
rl_nd1 = ef1*1:ncol(pc1))
pc1
system("locate net.rds")
getwd()
system("cp /home/sergio/MEGA/PhDgrive/papers/IBARRA/paperVEIN/vein_deliver/net.rds /home/sergio/MEGA/Libros/VEINBOOK/figuras")
net <- readRDS("figuras/net.rds")
head(net)
require(vein)
require(vein)
require(sf)
net <- readRDS("figuras/net.rds")
head(net)
net <- st_as_sf(net)
head(net)
net[1:2, ]
net[1, ]
units(net$lkm)
head(net$lkm)
require(units)
net$lkm <- set_units(st_length(net), km) #ensure units
head(net)
net <- readRDS("figuras/net.rds")
class(net)
PC_E25 <- age_ldv(net$ldv)
LT_B5 <- age_hdv(net$hdv)
data(fe2015)
EF_CO_PC_E25 <- EmissionFactorsList(fe2015[fe2015$Pollutant == "CO", "PC_G"])
EF_CO_PC_E25
EF_CO_LT_B5 <- EmissionFactorsList(fe2015[fe2015$Pollutant == "CO", "LT"])
EF_CO_LT_B5
install.packages("bookdown")
install.packages("bookdown")
install.packages("bookdown")
library(vein)
?emis
citation("vein")
print(citation("vein"), bibstyle = T)
?vein
bookdown::publish_book()
install.packages(c("rmarkdown", "bookdown"), dependencies = T)
install.packages(c("rmarkdown"), dependencies = T)
install.packages(c("remotes"), dependencies = T)
install.packages(c("remotes"))
install.packages(c("rmarkdown", "bookdown"))
install.packages(c("vein", "googleway", "eixport"))
install.packages("DiagrammeR")
install.packages("vein")
install.packages("vein", dependencies = T)
install.packages("eixport", dependencies = T)
install.packages("lwgeom", dependencies = T)
install.packages("sp", dependencies = T)
install.packages("vein", dependencies = T)
install.packages("raster",
dependencies = T)
install.packages("sf",
dependencies = T)
install.packages("mapview")
install.packages("sf", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("rgdal", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("tmap", dependencies = F)
install.packages("tmaptools", dependencies = F)
install.packages("rgeos", dependencies = T)
install.packages("rgeos", dependencies = F)
install.packages("rgeos", dependencies = F)
install.packages("rgeos", dependencies = F)
install.packages("rgeos", dependencies = F)
install.packages("rgeos", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("geojsonio", dependencies = T)
install.packages("maptools", dependencies = T)
install.packages("geojsonio", dependencies = T)
install.packages("codetools", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("tmap", dependencies = T)
install.packages("sf", dependencies = T)
install.packages("vein", dependencies = T)
install.packages(c("googleway", "eixport", "DiagrammeR"))
install.packages("remotes")
remotes::install_github("atmoschem/veinreport")
bookdown::publish_book()
install.packages("rsconnect", dependencies = T)
bookdown::publish_book()
install.packages("bookdown", dependencies = T)
install.packages(c("googleway", "DiagrammeR"))
install.packages(c("googleway"))
devtools::install_github("atmoschem/achemreport")
devtools::install_github("atmoschem/veineport")
devtools::install_github("atmoschem/veineport")
devtools::install_github("atmoschem/veineport")
devtools::install_github("atmoschem/veinreport")
library(Vein)
library(cein)
library(vein)
?ef_cetesb
library(vein)
args(ef_ive)
?ef_ive
data(fkm)
# cumulative mileage from 1 to 50 years of use, 40:50
mil <- cumsum(fkm$KM_PC_E25(1:50))
ef_ive("Truck/Bus", mileage = mil, pol = "CO_gkm")
ef_ive(mileage = mil, pol = "CO_gkm", details = TRUE)
args(ef_cetesb)
?ef_cetesb
args(ef_cetesb)
bookdown::publish_book()
?emis_dist
args(vein::emis_dist)
emis_dist
library(osmdata)
data(net)
net@data <- data.frame(hdv = net[["hdv"]])
g <- make_grid(spobj = net, width = 1/102.47/2)
netg <- emis_grid(net, g)
head(netg)
plot(netg["hdv"], axes = TRUE)
E_NOx_STREETS <- emis_post(E_NOx, by = "streets_wide", net = net)
library(vein)
library(veinreport)
library(cptcity)
library(ggplot2)
data(net)
data(profiles)
data(fe2015)
PC_G <- age_ldv(x = net$ldv, name = "PC")
# Estimation for 168 hour and local factors
pcw <- temp_fact(net$ldv, profiles$PC_JUNE_2014)
# June is not holliday in southern hemisphere
hdvw <- temp_fact(net$hdv, profiles$HGV_JUNE_2014)
speed <- netspeed(pcw + hdvw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
lef <- EmissionFactorsList(fe2015[fe2015$Pollutant=="CO", "PC_G"])
E_CO <- emis(veh = PC_G,lkm = net$lkm, ef = lef, speed = speed,
profile = profiles$PC_JUNE_2014)
E_CO_STREETS <- emis_post(E_CO, by = "streets_wide", net = net)
class(E_CO_STREETS)
ggplot(E_CO_STREETS) + geom_sf(aes(colour = as.numeric(V9))) +
scale_color_gradientn(colours = rev(cpt())) + theme_bw()+
ggtitle("CO emissions at 08:00 (g/h)")
LT <- age_hdv(x = net$hdv, name = "LT")
lef <- EmissionFactorsList(fe2015[fe2015$Pollutant=="NOx", "LT"])
E_NOx <- emis(veh = LT, lkm = net$lkm, ef = lef, speed = speed,
profile = profiles$PC_JUNE_2014)
E_NOx_STREETS <- emis_post(E_NOx, by = "streets_wide", net = net)
ggplot(E_NOx_STREETS) + geom_sf(aes(colour = as.numeric(V9))) +
scale_color_gradientn(colours = rev(cpt())) + theme_bw()+
ggtitle("NOX emissions at 08:00 (g/h)")
E_NOx_DF <- emis_post(arra = E_NOx, veh = "LT", size = "Small", fuel = "B5",
by = "veh", pollutant = "NOx")
head(E_NOx_DF)
E_NOx_STREETS <- emis_post(E_NOx, by = "streets_wide", net = net)
NOxg <- emis_grid(E_NOx_STREETS, g)
plot(NOxg["V1"], axes = TRUE)
names(E_NOx)
class(E_NOx)
sum(E_NOx)
library(osmdata)
library(sf, quietly = T)
osm <- osmdata_sf(
add_osm_feature(
opq(bbox = st_bbox(g)),
key = 'highway'))$osm_lines[, c("highway")]
st <- c("motorway", "motorway_link", "
trunk", "trunk_link",
"primary", "primary_link",
"secondary", "secondary_link",
"tertiary", "tertiary_link")
osm <- osm[osm$highway %in% st, ]
plot(osm, axes = T)
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
plot(estreet["emission"], axes = T,
pal = cpt(colorRampPalette = T))
5 / (1 + 2 + 3 + 4 + 5)
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet2 <- emis_dist(gy = sum(E_NOx), spobj = osm, osm = 5:1)
par(mfrow = c(1,2))
plot(estreet["emission"], axes = T,
pal = cpt(colorRampPalette = T))
plot(estreet2["emission"], axes = T,
pal = cpt(colorRampPalette = T))
par(mfrow = new)
estreet2
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet2 <- emis_dist(gy = sum(E_NOx), spobj = osm, osm = 5:1)
par(mfrow = c(1,2))
plot(estreet["emission"], axes = T,
pal = cpt(colorRampPalette = T))
plot(estreet2["emission"], axes = T,
pal = cpt(colorRampPalette = T))
par(mfrow = c(1,1))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet2 <- emis_dist(gy = sum(E_NOx), spobj = osm, osm = 5:1)
par(mfrow = c(1,2))
plot(estreet["emission"], axes = T,
pal = cpt(colorRampPalette = T))
plot(estreet2["emission"], axes = T,
pal = cpt(colorRampPalette = T))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet2 <- emis_dist(gy = sum(E_NOx), spobj = osm, osm = 5:1)
par(mfrow = c(1,2))
plot(estreet["emission"], axes = T,
pal = cpt(colorRampPalette = T))
plot(estreet2["emission"], axes = T,
pal = cpt(colorRampPalette = T))
EmissionFactors
par(mfrow = c(1,2))
plot(estreet["emission"], axes = T,pal = cpt(colorRampPalette = T))
plot(estreet2["emission"], axes = T,pal = cpt(colorRampPalette = T))
par(mfrow = c(1,2))
plot(1:3)
plot(1:5)
plot(estreet["emission"], axes = T,pal = cpt(colorRampPalette = T))
plot(estreet["emission"], axes = T,pal = cpt(colorRampPalette = T))
estreet$emissions_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emissions_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission", "emission_osm")],
axes = T,pal = cpt(colorRampPalette = T))
names(estreet)
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emission_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission", "emission_osm")],
axes = T,pal = cpt(colorRampPalette = T))
sum(estreet$emission)
sum(estreet$emission_osm)
plot(estreet[c("emission", "emission_osm")],  reset = T,
axes = T,pal = cpt(colorRampPalette = T))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emission_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission")],
main = paste0("Default distribution: ", sum(estreet$emission)),
axes = T,pal = cpt(colorRampPalette = T))
plot(estreet[c("emission_osm")],
main = paste0("Default distribution: ", sum(estreet$emission_osm)),
axes = T,pal = cpt(colorRampPalette = T))
plot(estreet[c("emission_osm")],
main = paste0("Default distribution: ",
round(sum(estreet$emission_osm))),
axes = T,pal = cpt(colorRampPalette = T))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emission_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission")],
main = paste0("Default distribution: ",
round(sum(estreet$emission))),
axes = T,pal = cpt(colorRampPalette = T))
plot(estreet[c("emission_osm")],
main = paste0("Default distribution: ",
round(sum(estreet$emission_osm))),
axes = T,pal = cpt(colorRampPalette = T))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emission_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission")],
main = paste0("Default distribution: ",
round(sum(estreet$emission))),
axes = T,pal = cpt(colorRampPalette = T))
plot(estreet[c("emission_osm")],
main = paste0("OSM distribution: ",
round(sum(estreet$emission_osm))),
axes = T,pal = cpt(colorRampPalette = T))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emission_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission")],
main = paste0("Emissions with Default distribution: ",
round(sum(estreet$emission))),
axes = T,pal = cpt(colorRampPalette = T))
plot(estreet[c("emission_osm")],
main = paste0("Emission with OSM distribution: ",
round(sum(estreet$emission_osm))),
axes = T,pal = cpt(colorRampPalette = T))
estreet <- emis_dist(gy = sum(E_NOx), spobj = osm)
estreet$emission_osm <- emis_dist(gy = sum(E_NOx), spobj = osm,
osm = 5:1)$emission
plot(estreet[c("emission")],
main = paste0("Emissions with Default distribution: ",
round(sum(estreet$emission)), " [g]"),
axes = T,pal = cpt(colorRampPalette = T))
plot(estreet[c("emission_osm")],
main = paste0("Emission with OSM distribution: ",
round(sum(estreet$emission_osm)), " [g]"),
axes = T,pal = cpt(colorRampPalette = T))
?grid_emis
args(vein::grid_emis)
xnet <- grid_emis(osm, NOxg)
names(NOxg)
NOxg <- NOxg[, "V1"]
names(NOxg)
names(NOxg)[1] <- "emission"
xnet <- grid_emis(osm, NOxg)
plot(xnet, axes = T,pal = cpt(colorRampPalette = T))
bookdown::publish_book()
