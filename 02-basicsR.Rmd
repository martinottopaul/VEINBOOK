# Basics of R {#basic}

## Brief history

R is a programming language developed by Ross Ihaka and Robert Genleman in 1993 [@ihaka1996r]. An excellent resource about R is the book  "Programming for data science"  [@peng2015r]. R is like a free version of S-PLUS programming language (http://www.solutionmetrics.com.au/products/splus/default.html). It is free and recognized as GNU software (https://www.gnu.org/software/software.html) with GNU General Public License (GPLV2-GPLV3) license. This feature allowed that many developers started improving and adding code over the years. 

R includes several statistical functions; therefore, users who want to use the base capabilities of R are not forced to learn R-programming. However, the evolution from user to developer in R has been facilitated with numerous publications such as the book "R packages: organize, test, document, and share your code" [@wickham2015r], or "The art of R programming: A tour of statistical software design" [@matloff2011art]. 

### Installation

R can be installed in different OS including Linux, Windows, Mac, and Solaris.  The webpage https://cran.r-project.org/ shows how to install R in any platform. A modern Integrated development environment (IDE) is **RStudio** https://www.rstudio.com/, which contains many useful integrated options.  However, you can run R on the terminal, and use any text editor to write and save scripts in R. Even more, you can run R scripts on the terminal by typing `Rscript -e "YourScript.R"`.

## Using R

If we type at the R promt 
```{r}
x <- 1   # Not printing  results
x        # Print results
print(x) # Explicit print x
```

The integer 1 was _assigned_ (<-) to x, then writing x or print(x) shows
the value of x. Instead of numbers, other expressions such as strings, dates or other objects can n be assigned. R includes several statistical functions. For instance, if we type 'pi' at the terminal, it prints
the _pi_ number.

```{r}
pi
```

### R objects

There are five basic classes (or atomic classes).

- character.
- numeric.
- integer.
- complex.
- logical (TRUE/FALSE or just T or F).

Objects of the same class can be grouped in **vectors**. You can createVectors are created with writing**c()** with the elements of the vector inside the parenthesis, separated by a colon. **c** is a built-in function to create vectors. In this case, the vector v1 contains a sequence of three integers, from 1 to 3. The resulting class is numeric.

```{r}
v1 <- 1:3
v2 <- c(1, 2, 3)
identical(v1, v2)
v1
class(v1)
```

With the operator `[` we can get specific elements of your vectors. In the 
following code, the function `length` is used additionally, which returns the length of an object.

```{r}
v1[1]          # first element of v1
v1[length(v1)] # last element element of v1
```

If we create a vector with numbers and letter, the resulting vector will
be "character", automatically converting the numbers into characters.

```{r}
v2 <- c(1:3,"a")
v2
class(v2)
```

Objects can be converted to other classes with the as.* functions. For instance, if we convert the vector v2 to numeric, it recognizes the numbers adding an `r NA` into the position of the character.

```{r}
as.numeric(v2)
```


### Factors

Factors represent categorical data. A typical example is a character vector of days of the week. The function `factor` creates factors. To see the help section, type  `?factor`. The following example uses this function with the arguments `x` and `levels`. 

```{r}
dow <- factor(x = c("Wednesday", "Monday", "Thursday", "Friday"),
              levels =  c("Monday", "Tuesday", "Wednesday", "Thursday",
                          "Friday"))
dow
```

### Missing Values

Missing values in data-sets are a typical source of a headache for R users. Fortunately, R counts with several tools to avoid these headaches. These tools are the functions `is.na` to check for NA (not available) and `is.nan` (not a number). This function returns logical values.

```{r}
n <- c(1, NA)
is.na(n)
n <- c(1, NaN)
is.na(n)
is.nan(n)
```


### Matrices

Matrix is a structure with rows and columns. They can be created using the `matrix` function and also, using vectors. Remember, if you want to know more about any function you have to type **?** and the function (e.g. `?matrix`), which opens the help documentation page. 

Let's create a matrix using vectors:

```{r}
a <- 1:12  #numeric vector
(m <- matrix(data = a, nrow = 3, ncol = 4))
```

We can check the dimensions of our matrix `m` with `dim`, which are 3 and 4.

```{r}
dim(m)
```

In order to get the elements of matrix `m` we can use the `[` operator:
```{r}
m[1, 1] # first element
m[, 1]  # firs column
m[1, ]  # firs row
m[3,4]  # last element
```


### Arrays

Arrays are like matrices inside other matrices. A matrix is a 2-dimensional array. Let's create an array create an array using the same vector `a` and same dimensions of `m`, 3 and 4. `array` has three arguments, `data`, `dim` and `dimnames`. In the argument `dim` let's add the number 2, resulting in an array of two matrices identical to `m`.

```{r}
(a <- array(data = a, dim = c(3,4,2)))
```

We can subset elements from array also with the `[` operator.

```{r}
a[1, 1, 1] # first element
dim(a)     # dimensions
a[3, 4, 2] # last element
```

### Lists

List are objects that can contain elements of different classes. I like to call lists as bags. In a bag, you can put almost anything. Also, inside the bag, you can put other bags with different things, meaning that you can have a list of lists of any R object. You can create lists with the `list` function. Let's create an empty list. Then I'm using the vector `a` to create another list.

```{r}
a <- 1:3          # vector of three elements
l1 <- list()      # empty list
l1 <- list(a)     # vector of three elements
length(l1)        # length 1
l1 <- as.list(a)  # vector a as list
length(l1)        # three elements 
```

As mentioned, the list can have lists inside.

```{r}
l1 <- list(list(a),                    # three numeric elements
            list(TRUE, TRUE, FALSE))   # three logical elements
length(l1)                             # length 2
```


### Data-Frames

"Data-frames are used to store tabular data in R" [@peng2015r]. You can think of data-frames as spreadsheet-like objects. They are similar to matrices, and you can have a matrix and a data.frame with the same dimensions. You have rows and columns, columns can have different classes, and the columns usually have a one-word name.

Programmers, scientists, and practitioners use tabular data. Hence,  there are R packages created to extend the capabilities of the data-frames. Below some of them:

- `data.frame` : This is not a package. It is a class and function from the `base` library in R. With this function you can create data-frames.
- `data-table` [@datatable]: `data.tables` objects have the class `data.table` Which inherits from the class `data-frame`, which means that they share common characteristics. However, the big difference with `data-table` is the efficiency with memory. It includes functions such as `fread` for reading millions of observations in seconds.
- `tidyr`[@tidyr]: Sometimes your data is in long format, and you need it in wide format, and vice-versa. This package does the job.
- `readxl` [@readxl]: a Good package for importing Excel and LibreOffice files. I recommend this packages for newbies.
- `sf` [@sf]: This package presents the class `sf` and introduces the list-column of spatial geometry.

Let's create a data.frame.

```{r}
a <- 1:3
b <- 3:5
(ab <- data.frame(a, b))
class(ab)
```


### Names

In R you can put names in almost everything. Below examples for `vectors`,  `matrix` and `data.frames`.

```{r}
names(ab)                # original names
names(ab) <- c("c", "d")
names(ab)                # new names
```
### Subseting your data.frame

There are several packages for filtering and manipulating data.frames and databases, such as the famous `dplyr` [@dplyr]. However, I will mention an essential characteristic to filter data.frames, and it is not necessary for any new package, consisted in subsetting using indices. Recall that data.frames are similar matrices, and you can select values with this structure: _[rows, columns]_.

Let's create a data.frame with three columns and select all commons that match criteria for a row. Specifically, the column a fas rows with values equal of 2

```{r }
df <- data.frame(a = 1:3, b = 4:6, c = 7:9)
(aa <- df[df$a == 2,])
class(aa)
```
here we are selecting all columns and the class of `aa` is `data.frame`. The same applies for selecting columns, lets select the columns "b" and "c".

```{r }
(df[, c("b", "c")])
```


## Inputting data into R

Your data can be in different formats. In this section, I'm showing you how you can input text and comma separated value files, which is a ubiquitous task.  Let's say that you are using a spreadsheet program such as Microsoft Excel or LibreOffice. Then you might want to import your data into R.

- Your first check is if the first row of your data has a name or not.
If they do have names, this means that they have a header.
- Then click on 'Save as' and search text file with extension .txt or .csv.
- Then you edit your file with notepad (e.g., bloc, gedit, vi or another tool)
to check if the decimal character is a point '.' so the separator character is a comma ',' or semicolon ';' or another character, which depends on the local configuration of your spreadsheet software.
- If your file has the extension '.txt', use `read.table` and if it  is '.csv', 
use `read.csv`.

Once you checked the format, you can import your '.txt' or '.csv' files in R:

```{r eval = FALSE}
a <- read.csv("path/to/file.csv", sep = ",",
              header = T, stringsAsFactors = F)
a <- read.table("path/to/file.txt", sep = ",",
                header = T, stringsAsFactors = F)
```

