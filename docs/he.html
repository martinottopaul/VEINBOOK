<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Vehicular emissions inventory with VEIN</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Vehicular emissions inventory with VEIN" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="ibarraespinosa/veinbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Vehicular emissions inventory with VEIN" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Sergio Ibarra-Espinosa">


<meta name="date" content="2018-09-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="post.html">
<link rel="next" href="ep.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">veinbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i>Purpose</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#definitions-and-sources-of-information"><i class="fa fa-check"></i><b>1.1</b> Definitions and sources of information</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#approaches"><i class="fa fa-check"></i><b>1.1.1</b> Approaches</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#required-r-packages-and-dependencies"><i class="fa fa-check"></i><b>1.3</b> Required R packages and dependencies</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#data-inside-the-vein-model"><i class="fa fa-check"></i><b>1.4</b> Data inside the VEIN model</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#emission-factors-from-cetesb"><i class="fa fa-check"></i><b>1.4.1</b> Emission factors from CETESB</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#mileage-functions-of-brazilian-fleet"><i class="fa fa-check"></i><b>1.4.2</b> Mileage functions of Brazilian Fleet</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#temporal-factors-for-passenger-cars"><i class="fa fa-check"></i><b>1.4.3</b> Temporal factors for Passenger Cars</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#profile-for-cold-starts-of-passenger-cars"><i class="fa fa-check"></i><b>1.4.4</b> Profile for cold starts of Passenger Cars</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic.html"><a href="basic.html"><i class="fa fa-check"></i><b>2</b> Basics of R</a><ul>
<li class="chapter" data-level="2.1" data-path="basic.html"><a href="basic.html#brief-history"><i class="fa fa-check"></i><b>2.1</b> Brief history</a><ul>
<li class="chapter" data-level="2.1.1" data-path="basic.html"><a href="basic.html#installation-1"><i class="fa fa-check"></i><b>2.1.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basic.html"><a href="basic.html#using-r"><i class="fa fa-check"></i><b>2.2</b> Using R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="basic.html"><a href="basic.html#r-objects"><i class="fa fa-check"></i><b>2.2.1</b> R objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="basic.html"><a href="basic.html#factors"><i class="fa fa-check"></i><b>2.2.2</b> Factors</a></li>
<li class="chapter" data-level="2.2.3" data-path="basic.html"><a href="basic.html#missing-values"><i class="fa fa-check"></i><b>2.2.3</b> Missing Values</a></li>
<li class="chapter" data-level="2.2.4" data-path="basic.html"><a href="basic.html#matrices"><i class="fa fa-check"></i><b>2.2.4</b> Matrices</a></li>
<li class="chapter" data-level="2.2.5" data-path="basic.html"><a href="basic.html#arrays"><i class="fa fa-check"></i><b>2.2.5</b> Arrays</a></li>
<li class="chapter" data-level="2.2.6" data-path="basic.html"><a href="basic.html#lists"><i class="fa fa-check"></i><b>2.2.6</b> Lists</a></li>
<li class="chapter" data-level="2.2.7" data-path="basic.html"><a href="basic.html#data-frames"><i class="fa fa-check"></i><b>2.2.7</b> Data-Frames</a></li>
<li class="chapter" data-level="2.2.8" data-path="basic.html"><a href="basic.html#names"><i class="fa fa-check"></i><b>2.2.8</b> Names</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basic.html"><a href="basic.html#inputting-data-into-r"><i class="fa fa-check"></i><b>2.3</b> Inputting data into R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="st.html"><a href="st.html"><i class="fa fa-check"></i><b>3</b> Structuring an Emissions Inventory</a><ul>
<li class="chapter" data-level="3.1" data-path="st.html"><a href="st.html#veinstructure"><i class="fa fa-check"></i><b>3.1</b> Overview of emissions inventorying using VEIN</a></li>
<li class="chapter" data-level="3.2" data-path="st.html"><a href="st.html#the-inventory-function"><i class="fa fa-check"></i><b>3.2</b> The <code>inventory</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="traffic.html"><a href="traffic.html"><i class="fa fa-check"></i><b>4</b> Traffic data</a><ul>
<li class="chapter" data-level="4.1" data-path="traffic.html"><a href="traffic.html#sources-of-traffic-data"><i class="fa fa-check"></i><b>4.1</b> Sources of traffic data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="traffic.html"><a href="traffic.html#travel-demand-outputs"><i class="fa fa-check"></i><b>4.1.1</b> Travel demand outputs</a></li>
<li class="chapter" data-level="4.1.2" data-path="traffic.html"><a href="traffic.html#inteprolation-of-traffic-counts"><i class="fa fa-check"></i><b>4.1.2</b> Inteprolation of traffic counts</a></li>
<li class="chapter" data-level="4.1.3" data-path="traffic.html"><a href="traffic.html#generating-traffic-flows-from-origin-destination-surveys-ods"><i class="fa fa-check"></i><b>4.1.3</b> Generating traffic flows from Origin-Destination-Surveys (ODS)</a></li>
<li class="chapter" data-level="4.1.4" data-path="traffic.html"><a href="traffic.html#top-down-approach"><i class="fa fa-check"></i><b>4.1.4</b> Top-down approach</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="traffic.html"><a href="traffic.html#main-functions"><i class="fa fa-check"></i><b>4.2</b> Main functions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="traffic.html"><a href="traffic.html#expanding-traffic-data-with-the-function-temp_fact"><i class="fa fa-check"></i><b>4.2.1</b> Expanding traffic data with the function <code>temp_fact</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="traffic.html"><a href="traffic.html#calculating-speed-at-other-hours-with-the-function-netspeed"><i class="fa fa-check"></i><b>4.2.2</b> Calculating speed at other hours with the function <code>netspeed</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="traffic.html"><a href="traffic.html#distribution-of-vehicles-by-age-of-use-with-the-functions-age_ldv-age_hdv-and-age_moto"><i class="fa fa-check"></i><b>4.2.3</b> Distribution of vehicles by age of use with the functions <code>age_ldv</code>, <code>age_hdv</code> and <code>age_moto</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="traffic.html"><a href="traffic.html#the-function-my_age"><i class="fa fa-check"></i><b>4.2.4</b> The function <code>my_age</code></a></li>
<li class="chapter" data-level="4.2.5" data-path="traffic.html"><a href="traffic.html#the-class-vehicles"><i class="fa fa-check"></i><b>4.2.5</b> The class <code>Vehicles</code></a></li>
<li class="chapter" data-level="4.2.6" data-path="traffic.html"><a href="traffic.html#other-traffic-functions"><i class="fa fa-check"></i><b>4.2.6</b> Other traffic functions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="traffic.html"><a href="traffic.html#vehicular-composition"><i class="fa fa-check"></i><b>4.3</b> Vehicular composition</a></li>
<li class="chapter" data-level="4.4" data-path="traffic.html"><a href="traffic.html#application"><i class="fa fa-check"></i><b>4.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ef.html"><a href="ef.html"><i class="fa fa-check"></i><b>5</b> Emission Factors</a><ul>
<li class="chapter" data-level="5.1" data-path="ef.html"><a href="ef.html#speedef"><i class="fa fa-check"></i><b>5.1</b> Speed functions <code>ef_ldv_speed</code> and <code>ef_hdv_speed</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="ef.html"><a href="ef.html#emission-factors-of-ldv-depending-on-speed-with-the-function-ef_ldv_speed"><i class="fa fa-check"></i><b>5.1.1</b> Emission factors of LDV depending on speed with the function <code>ef_ldv_speed</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="ef.html"><a href="ef.html#emission-factors-of-hdv-depending-on-speed-with-the-function-ef_hdv_speed"><i class="fa fa-check"></i><b>5.1.2</b> Emission factors of HDV depending on speed with the function <code>ef_hdv_speed</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ef.html"><a href="ef.html#localef"><i class="fa fa-check"></i><b>5.2</b> Local emission factors by age of use. The functions <code>EmissionFactors</code> and <code>EmissionFactorsList</code></a></li>
<li class="chapter" data-level="5.3" data-path="ef.html"><a href="ef.html#scale"><i class="fa fa-check"></i><b>5.3</b> Incorporating speed variation with the functions <code>ef_ldv_scaled</code> and <code>ef_hdv_scaled</code></a></li>
<li class="chapter" data-level="5.4" data-path="ef.html"><a href="ef.html#cold-starts"><i class="fa fa-check"></i><b>5.4</b> Cold Starts</a></li>
<li class="chapter" data-level="5.5" data-path="ef.html"><a href="ef.html#det"><i class="fa fa-check"></i><b>5.5</b> Deterioration</a></li>
<li class="chapter" data-level="5.6" data-path="ef.html"><a href="ef.html#evaporative-emissions-ef_evap"><i class="fa fa-check"></i><b>5.6</b> Evaporative emissions <code>ef_evap</code></a></li>
<li class="chapter" data-level="5.7" data-path="ef.html"><a href="ef.html#emission-factors-of-wear-ef_wear"><i class="fa fa-check"></i><b>5.7</b> Emission factors of wear <code>ef_wear</code></a></li>
<li class="chapter" data-level="5.8" data-path="ef.html"><a href="ef.html#emission-factors-from-tunnel-studies"><i class="fa fa-check"></i><b>5.8</b> Emission factors from tunnel studies</a></li>
<li class="chapter" data-level="5.9" data-path="ef.html"><a href="ef.html#emission-factors-from-international-vehicle-emissions-ive"><i class="fa fa-check"></i><b>5.9</b> Emission factors from International Vehicle Emissions (IVE)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="est.html"><a href="est.html"><i class="fa fa-check"></i><b>6</b> Estimation of emissions</a><ul>
<li class="chapter" data-level="6.1" data-path="est.html"><a href="est.html#the-emis-function"><i class="fa fa-check"></i><b>6.1</b> The <code>emis</code> function</a></li>
<li class="chapter" data-level="6.2" data-path="est.html"><a href="est.html#the-emis_cold-function"><i class="fa fa-check"></i><b>6.2</b> The <code>emis_cold</code> function</a></li>
<li class="chapter" data-level="6.3" data-path="est.html"><a href="est.html#the-emis_evap-function"><i class="fa fa-check"></i><b>6.3</b> The <code>emis_evap</code> function</a></li>
<li class="chapter" data-level="6.4" data-path="est.html"><a href="est.html#the-emis_paved-function"><i class="fa fa-check"></i><b>6.4</b> The <code>emis_paved</code> function</a></li>
<li class="chapter" data-level="6.5" data-path="est.html"><a href="est.html#ew"><i class="fa fa-check"></i><b>6.5</b> The <code>emis_wear</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="post.html"><a href="post.html"><i class="fa fa-check"></i><b>7</b> Post estimation with <code>emis_post</code></a><ul>
<li class="chapter" data-level="7.1" data-path="post.html"><a href="post.html#emissions-by-street"><i class="fa fa-check"></i><b>7.1</b> Emissions by street</a></li>
<li class="chapter" data-level="7.2" data-path="post.html"><a href="post.html#total-emissions-in-data-frames"><i class="fa fa-check"></i><b>7.2</b> Total emissions in data-frames</a></li>
<li class="chapter" data-level="7.3" data-path="post.html"><a href="post.html#merging-emissions"><i class="fa fa-check"></i><b>7.3</b> Merging emissions</a></li>
<li class="chapter" data-level="7.4" data-path="post.html"><a href="post.html#creating-grids"><i class="fa fa-check"></i><b>7.4</b> Creating grids</a></li>
<li class="chapter" data-level="7.5" data-path="post.html"><a href="post.html#gridding-emissions-with-emis_grid"><i class="fa fa-check"></i><b>7.5</b> Gridding emissions with <code>emis_grid</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="he.html"><a href="he.html"><i class="fa fa-check"></i><b>8</b> Speciation</a><ul>
<li class="chapter" data-level="8.1" data-path="he.html"><a href="he.html#speed-functions-of-voc-species"><i class="fa fa-check"></i><b>8.1</b> Speed functions of VOC species</a></li>
<li class="chapter" data-level="8.2" data-path="he.html"><a href="he.html#speciate-function"><i class="fa fa-check"></i><b>8.2</b> Speciate function</a></li>
<li class="chapter" data-level="8.3" data-path="he.html"><a href="he.html#black-carbon-and-organic-matter"><i class="fa fa-check"></i><b>8.3</b> Black carbon and organic matter</a></li>
<li class="chapter" data-level="8.4" data-path="he.html"><a href="he.html#tyre-wear-breaks-wear-and-road-abrassion"><i class="fa fa-check"></i><b>8.4</b> Tyre wear, breaks wear and road abrassion</a></li>
<li class="chapter" data-level="8.5" data-path="he.html"><a href="he.html#no-and-no_2"><i class="fa fa-check"></i><b>8.5</b> <span class="math inline">\(NO\)</span> and <span class="math inline">\(NO_2\)</span></a></li>
<li class="chapter" data-level="8.6" data-path="he.html"><a href="he.html#volatile-organic-compounds-nmhc"><i class="fa fa-check"></i><b>8.6</b> Volatile organic compounds: <code>nmhc</code></a></li>
<li class="chapter" data-level="8.7" data-path="he.html"><a href="he.html#the-speciation-iag"><i class="fa fa-check"></i><b>8.7</b> The speciation <code>iag</code></a></li>
<li class="chapter" data-level="8.8" data-path="he.html"><a href="he.html#the-speciation-pmiag"><i class="fa fa-check"></i><b>8.8</b> The speciation <code>pmiag</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ep.html"><a href="ep.html"><i class="fa fa-check"></i><b>9</b> Inputs for atmospheric models with <code>eixport</code> Package</a><ul>
<li class="chapter" data-level="9.1" data-path="ep.html"><a href="ep.html#wrfchem-input-with-wrfinput-and-griddedemissionsarray"><i class="fa fa-check"></i><b>9.1</b> WRFChem input with wrfinput and <code>GriddedEmissionsArray</code></a><ul>
<li class="chapter" data-level="9.1.1" data-path="ep.html"><a href="ep.html#creating-a-wrf-chem-input-file"><i class="fa fa-check"></i><b>9.1.1</b> Creating a WRF-Chem input file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="check.html"><a href="check.html"><i class="fa fa-check"></i><b>10</b> Quality check and errors</a><ul>
<li class="chapter" data-level="10.1" data-path="check.html"><a href="check.html#guidance-from-emepeea-air-pollutant-emission-inventory-guidebook"><i class="fa fa-check"></i><b>10.1</b> Guidance from EMEP/EEA air pollutant emission inventory guidebook</a><ul>
<li class="chapter" data-level="10.1.1" data-path="check.html"><a href="check.html#key-categories"><i class="fa fa-check"></i><b>10.1.1</b> Key categories</a></li>
<li class="chapter" data-level="10.1.2" data-path="check.html"><a href="check.html#uncertainty"><i class="fa fa-check"></i><b>10.1.2</b> Uncertainty</a></li>
<li class="chapter" data-level="10.1.3" data-path="check.html"><a href="check.html#quality-assurance-and-quality-check"><i class="fa fa-check"></i><b>10.1.3</b> Quality Assurance and Quality Check</a></li>
<li class="chapter" data-level="10.1.4" data-path="check.html"><a href="check.html#inventory-managment-cycle"><i class="fa fa-check"></i><b>10.1.4</b> Inventory managment cycle</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="check.html"><a href="check.html#avoiding-errors-with-vein"><i class="fa fa-check"></i><b>10.2</b> Avoiding errors with VEIN</a><ul>
<li class="chapter" data-level="10.2.1" data-path="check.html"><a href="check.html#traffic-flow"><i class="fa fa-check"></i><b>10.2.1</b> Traffic flow</a></li>
<li class="chapter" data-level="10.2.2" data-path="check.html"><a href="check.html#vehicular-composition-2"><i class="fa fa-check"></i><b>10.2.2</b> Vehicular composition</a></li>
<li class="chapter" data-level="10.2.3" data-path="check.html"><a href="check.html#units"><i class="fa fa-check"></i><b>10.2.3</b> Units</a></li>
<li class="chapter" data-level="10.2.4" data-path="check.html"><a href="check.html#emission-factors-1"><i class="fa fa-check"></i><b>10.2.4</b> Emission factors</a></li>
<li class="chapter" data-level="10.2.5" data-path="check.html"><a href="check.html#deterioration"><i class="fa fa-check"></i><b>10.2.5</b> Deterioration</a></li>
<li class="chapter" data-level="10.2.6" data-path="check.html"><a href="check.html#fuel-evaluation"><i class="fa fa-check"></i><b>10.2.6</b> Fuel evaluation</a></li>
<li class="chapter" data-level="10.2.7" data-path="check.html"><a href="check.html#emissions-estimation"><i class="fa fa-check"></i><b>10.2.7</b> Emissions estimation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendix-a-fast-example-of-vein.html"><a href="appendix-a-fast-example-of-vein.html"><i class="fa fa-check"></i>Appendix A: Fast Example of VEIN</a></li>
<li class="chapter" data-level="" data-path="appendix-b-detailed-example-of-vein.html"><a href="appendix-b-detailed-example-of-vein.html"><i class="fa fa-check"></i>Appendix B: Detailed Example of VEIN</a><ul>
<li class="chapter" data-level="A.3" data-path="appendix-b-detailed-example-of-vein.html"><a href="appendix-b-detailed-example-of-vein.html#network-1"><i class="fa fa-check"></i><b>A.3</b> Network</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-b-detailed-example-of-vein.html"><a href="appendix-b-detailed-example-of-vein.html#vehicular-composition-cetesb2015"><i class="fa fa-check"></i><b>A.4</b> Vehicular composition <span class="citation">(CETESB <a href="#ref-CETESB2015">2015</a>)</span></a></li>
<li class="chapter" data-level="A.5" data-path="appendix-b-detailed-example-of-vein.html"><a href="appendix-b-detailed-example-of-vein.html#traffic-data"><i class="fa fa-check"></i><b>A.5</b> Traffic data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i>Appendix B</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Vehicular emissions inventory with VEIN</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="he" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Speciation</h1>
<p>The speciation for emissions is a very important part that deserves a only chapter on this book. VEIN initially covered speed functions emission factors of CO, HC, NOx, PM and Fuel Consumption (FC). But currently, the the pollutants covered are:</p>
<ul>
<li><strong>Criteria</strong>: “CO”, “NOx”, “HC”, “PM”, “CH4”, “NMHC”, “CO2”, “SO2”, “Pb”, “FC” (Fuel Consumption).</li>
<li><strong>Polycyclic Aromatic Hydrocarbons (PAH) and Persisten Organic Pollutants (POP)</strong>: “indeno(1,2,3-cd)pyrene”, “benzo(k)fluoranthene”, “benzo(b)fluoranthene”, “benzo(ghi)perylene”, “fluoranthene”, “benzo(a)pyrene”, “pyrene”, “perylene”, “anthanthrene”, “benzo(b)fluorene”, “benzo(e)pyrene”, “triphenylene”, “benzo(j)fluoranthene”, “dibenzo(a,j)anthacene”, “dibenzo(a,l)pyrene”, “3,6-dimethyl-phenanthrene”, “benzo(a)anthracene”, “acenaphthylene”, “acenapthene”, “fluorene”, “chrysene”, “phenanthrene”, “napthalene”, “anthracene”, “coronene”, “dibenzo(ah)anthracene”</li>
<li><strong>Dioxins and Furans</strong>: “PCDD”, “PCDF”, “PCB”.</li>
<li><strong>Metals</strong>: “As”, “Cd”, “Cr”, “Cu”, “Hg”, “Ni”, “Pb”, “Se”, “Zn”.</li>
<li><strong>NMHC</strong>:</li>
<li><em>ALKANES</em>: “ethane”, “propane”, “butane”, “isobutane”, “pentane”, “isopentane”, “hexane”, “heptane”, “octane”, “TWO_methylhexane”, “nonane”, “TWO_methylheptane”, “THREE_methylhexane”, “decane”, “THREE_methylheptane”, “alcanes_C10_C12”, “alkanes_C13”.</li>
<li><em>CYCLOALKANES</em>: “cycloalcanes”.</li>
<li><em>ALKENES</em>: “ethylene”, “propylene”, “propadiene”, “ONE_butene”, “isobutene”, “TWO_butene”, “ONE_3_butadiene”, “ONE_pentene”, “TWO_pentene”, “ONE_hexene”, “dimethylhexene”.</li>
<li><em>ALKYNES</em>:“ONE_butine”, “propine”, “acetylene”.</li>
<li><em>ALDEHYDES</em>: “formaldehyde”, “acetaldehyde”, “acrolein”, “benzaldehyde”, “crotonaldehyde”, “methacrolein”, “butyraldehyde”, “isobutanaldehyde”, “propionaldehyde”, “hexanal”, “i_valeraldehyde”, “valeraldehyde”, “o_tolualdehyde”, “m_tolualdehyde”, “p_tolualdehyde”.</li>
<li>KETONES: “acetone”, “methylethlketone”.</li>
<li><em>AROMATICS</em>: “toluene”, “ethylbenzene”, “m_p_xylene”, “o_xylene”, “ONE_2_3_trimethylbenzene”, “ONE_2_4_trimethylbenzene”, “ONE_3_5_trimethylbenzene”, “styrene”, “benzene”, “C9”, “C10”, “C13”.</li>
</ul>
<p>Also, some Brazilian emission factors and speciations for WRF-Chem, mechanisms: “e_eth”, “e_hc3”, “e_hc5”, “e_hc8”, “e_ol2”, “e_olt”, “e_oli”, “e_iso”, “e_tol”, “e_xyl”, “e_c2h5oh”, “e_ald”, “e_hcho”, “e_ch3oh”, “e_ket”, “E_SO4i”, “E_SO4j”, “E_NO3i”, “E_NO3j”, “E_MP2.5i”, “E_MP2.5j”, “E_ORGi”, “E_ORGj”, “E_ECi”, “E_ECj”, “H2O”.</p>
<p>By the end of this book, more emission factors will be added.</p>
<p>Because VEIN has the capabilities to produce species from this pollutants including volatile organic compunds (VOC) and particulate matter compounds.</p>
<p>The speciation of emissions in VEIN can be done with three ways, by selecting the pollutants in ef_speed* functions, other way explicit and the other implicit. The explicit way is by usint the function <code>speciate</code> for the specific available speciation. The implicit way is by adding a percentage value in the argument <code>k</code> in any of the functions of emission factors. The implicit way requires that the user must know the percentage of the species of pollutant.</p>
<div id="speed-functions-of-voc-species" class="section level2">
<h2><span class="header-section-number">8.1</span> Speed functions of VOC species</h2>
<p>As mentioned before, the speed function emission factors, currently covers several pollutants. We firstly focus on som PAH and POP. They way to select them is just:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
pol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;indeno(1,2,3-cd)pyrene&quot;</span>, <span class="st">&quot;benzo(k)fluoranthene&quot;</span>,
         <span class="st">&quot;benzo(b)fluoranthene&quot;</span>, <span class="st">&quot;benzo(ghi)perylene&quot;</span>, <span class="st">&quot;fluoranthene&quot;</span>,
         <span class="st">&quot;benzo(a)pyrene&quot;</span>)
df &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pol), <span class="cf">function</span>(i){
  <span class="kw">EmissionFactors</span>(<span class="kw">ef_ldv_speed</span>(<span class="st">&quot;PC&quot;</span>, <span class="st">&quot;4S&quot;</span>, <span class="st">&quot;&lt;=1400&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;PRE&quot;</span>,
                               pol[i], <span class="dt">x =</span> <span class="dv">10</span>)(<span class="dv">10</span>))
})
<span class="kw">names</span>(df) &lt;-<span class="st"> </span>pol
df</code></pre></div>
<pre><code>## $`indeno(1,2,3-cd)pyrene`
## 1.03e-06 [g/km]
## 
## $`benzo(k)fluoranthene`
## 3e-07 [g/km]
## 
## $`benzo(b)fluoranthene`
## 8.8e-07 [g/km]
## 
## $`benzo(ghi)perylene`
## 2.9e-06 [g/km]
## 
## $fluoranthene
## 1.822e-05 [g/km]
## 
## $`benzo(a)pyrene`
## 4.8e-07 [g/km]</code></pre>
<p>These pollutants comes from <span class="citation">Ntziachristos and Samaras (<a href="#ref-NtziachristosSamaras2016">2016</a>)</span> and in this case, are not dependent on speed. I used lapply to iterate in each pollutant at 10 km/h. Now I will show the same for dioxins and furans.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
pol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PCDD&quot;</span>, <span class="st">&quot;PCDF&quot;</span>, <span class="st">&quot;PCB&quot;</span>)
df &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pol), <span class="cf">function</span>(i){
  <span class="kw">EmissionFactors</span>(<span class="kw">ef_ldv_speed</span>(<span class="st">&quot;PC&quot;</span>, <span class="st">&quot;4S&quot;</span>, <span class="st">&quot;&lt;=1400&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;PRE&quot;</span>,
                               pol[i], <span class="dt">x =</span> <span class="dv">10</span>)(<span class="dv">10</span>))
})
<span class="kw">names</span>(df) &lt;-<span class="st"> </span>pol
df</code></pre></div>
<pre><code>## $PCDD
## 1.03e-11 [g/km]
## 
## $PCDF
## 2.12e-11 [g/km]
## 
## $PCB
## 6.4e-12 [g/km]</code></pre>
<p>In the case of nmhc, the estimation is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
pol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ethane&quot;</span>, <span class="st">&quot;propane&quot;</span>, <span class="st">&quot;butane&quot;</span>, <span class="st">&quot;isobutane&quot;</span>, <span class="st">&quot;pentane&quot;</span>)
df &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pol), <span class="cf">function</span>(i){
  <span class="kw">EmissionFactors</span>(<span class="kw">ef_ldv_speed</span>(<span class="st">&quot;PC&quot;</span>, <span class="st">&quot;4S&quot;</span>, <span class="st">&quot;&lt;=1400&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;PRE&quot;</span>,
                               pol[i], <span class="dt">x =</span> <span class="dv">10</span>)(<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>)))
})
<span class="kw">names</span>(df) &lt;-<span class="st"> </span>pol
df</code></pre></div>
<pre><code>## $ethane
## Units: [g/km]
## [1] 0.09934632 0.06062781 0.04524681
## 
## $propane
## Units: [g/km]
## [1] 0.02829865 0.01726974 0.01288849
## 
## $butane
## Units: [g/km]
## [1] 0.1746087 0.1065580 0.0795247
## 
## $isobutane
## Units: [g/km]
## [1] 0.07767076 0.04739993 0.03537478
## 
## $pentane
## Units: [g/km]
## [1] 0.10717361 0.06540455 0.04881171</code></pre>
<p>Now the same example for one pollutant and several euro standards.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
euro &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V&quot;</span>, <span class="st">&quot;IV&quot;</span>, <span class="st">&quot;III&quot;</span>, <span class="st">&quot;II&quot;</span>,<span class="st">&quot;I&quot;</span>, <span class="st">&quot;PRE&quot;</span>)
df &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(euro), <span class="cf">function</span>(i){
  <span class="kw">EmissionFactors</span>(<span class="kw">ef_ldv_speed</span>(<span class="st">&quot;PC&quot;</span>, <span class="st">&quot;4S&quot;</span>, <span class="st">&quot;&lt;=1400&quot;</span>, <span class="st">&quot;G&quot;</span>, euro[i],
                               <span class="st">&quot;benzene&quot;</span>)(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>)))
})
<span class="kw">names</span>(df) &lt;-<span class="st"> </span>euro
df</code></pre></div>
<pre><code>## $V
## Units: [g/km]
## [1] 0.0003928819 0.0002194495 0.0001597751
## 
## $IV
## Units: [g/km]
## [1] 0.0004864655 0.0004872061 0.0005276205
## 
## $III
## Units: [g/km]
## [1] 0.0017465678 0.0008206890 0.0005928019
## 
## $II
## Units: [g/km]
## [1] 0.013332523 0.004133087 0.002363304
## 
## $I
## Units: [g/km]
## [1] 0.025656752 0.010921829 0.006979341
## 
## $PRE
## Units: [g/km]
## [1] 0.4112336 0.1872944 0.1287895</code></pre>
</div>
<div id="speciate-function" class="section level2">
<h2><span class="header-section-number">8.2</span> Speciate function</h2>
<p>The arguments of the function <code>speciate</code> are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(vein<span class="op">::</span>speciate)</code></pre></div>
<pre><code>## function (x, spec = &quot;bcom&quot;, veh, fuel, eu, show = FALSE, list = FALSE, 
##     dx) 
## NULL</code></pre>
<p>Where,</p>
<ul>
<li><code>x</code>: Emissions estimation</li>
<li><code>spec</code>: speciation: The speciations are: “bcom”, tyre“,”break“,”road“,”iag“,”nox&quot; and “nmhc”. ‘iag’ now includes a speciation for use of industrial and building paintings. “bcom” stands for black carbon and organic matter.</li>
<li><code>veh</code>: Type of vehicle: When spec is “bcom” or “nox” veh can be “PC”, “LCV”, HDV&quot; or “Motorcycle”. When spec is “iag” veh can take two values depending: when the speciation is for vehicles veh accepts “veh”, eu “Evaporative”, “Liquid” or “Exhaust” and fuel “G”, “E” or “D”, when the speciation is for painting, veh is “paint” fuel or eu can be “industrial” or “building” when spec is “nmhc”, veh can be “LDV” with fuel “G” or “D” and eu “PRE”, “I”, “II”, “III”, “IV”, “V”, or “VI”. when spec is “nmhc”, veh can be “HDV” with fuel “D” and eu “PRE”, “I”, “II”, “III”, “IV”, “V”, or “VI”. when spec is “nmhc” and fuel is “LPG”, veh and eu must be “ALL”</li>
<li><code>fuel</code>: Fuel. When spec is “bcom” fuel can be “G” or “D”. When spec is “iag” fuel can be “G”, “E” or “D”. When spec is “nox” fuel can be “G”, “D”, “LPG”, “E85” or “CNG”. Not required for “tyre”, “break” or “road”. When spec is “nmhc” fuel can be G, D or LPG.</li>
<li><code>eu</code>: sEuro emission standard: “PRE”, “ECE_1501”, “ECE_1502”, “ECE_1503”, “I”, “II”, “III”, “IV”, “V”, “III-CDFP”,“IV-CDFP”,“V-CDFP”, “III-ADFP”, “IV-ADFP”,“V-ADFP” and “OPEN_LOOP”. When spec is “iag” accept the values “Exhaust” “Evaporative” and “Liquid”. When spec is “nox” eu can be “PRE”, “I”, “II”, “III”, “IV”, “V”, “VI”, “VIc”, “III-DPF” or “III+CRT”. Not required for “tyre”, “break” or “road”</li>
<li><code>show</code>: when TRUE shows row of table with respective speciation</li>
<li><code>list</code>: when TRUE returns a list with number of elements of the list as the number species of pollutants</li>
</ul>
<p>As shown before, there are currently 8 type of speciations. Now, i will show examples for most of them.</p>
</div>
<div id="black-carbon-and-organic-matter" class="section level2">
<h2><span class="header-section-number">8.3</span> Black carbon and organic matter</h2>
<p>Let’s use the data inside the vein and estimate emissions. The vehicles considered are Light Trucks, assuming all HGV. We are using the 4 stage estimation with the first part arranging traffic data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
<span class="co"># 1 Traffic data</span>
<span class="kw">data</span>(net)
<span class="kw">data</span>(profiles)
<span class="kw">data</span>(fe2015)
lt &lt;-<span class="st"> </span><span class="kw">age_hdv</span>(net<span class="op">$</span>ldv)</code></pre></div>
<pre><code>## Average age of age is 17.12</code></pre>
<pre><code>## Number of age is 1946.95 * 10^3 veh</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vw &lt;-<span class="st"> </span><span class="kw">temp_fact</span>(net<span class="op">$</span>ldv, profiles<span class="op">$</span>PC_JUNE_<span class="dv">2014</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">temp_fact</span>(net<span class="op">$</span>hdv, profiles<span class="op">$</span>HGV_JUNE_<span class="dv">2014</span>)
speed &lt;-<span class="st"> </span><span class="kw">netspeed</span>(vw, net<span class="op">$</span>ps, net<span class="op">$</span>ffs, net<span class="op">$</span>capacity, net<span class="op">$</span>lkm, <span class="dt">alpha =</span> <span class="dv">1</span>)
<span class="co"># 2 Emission factors</span>
euro &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;IV&quot;</span>, <span class="dv">3</span>),  
          <span class="kw">rep</span>(<span class="st">&quot;III&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;II&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;I&quot;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&quot;PRE&quot;</span>, <span class="dv">27</span>))
lefd &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) {
  <span class="kw">ef_hdv_speed</span>(<span class="dt">v =</span> <span class="st">&quot;Trucks&quot;</span>, <span class="dt">t =</span> <span class="st">&quot;RT&quot;</span>, <span class="dt">g =</span> <span class="st">&quot;&gt;32&quot;</span>, <span class="dt">gr =</span> <span class="dv">0</span>,
               <span class="dt">eu =</span> euro[i], <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">p =</span> <span class="st">&quot;PM&quot;</span>,
               <span class="dt">show.equation =</span> <span class="ot">FALSE</span>) })
<span class="co"># 3 Estimate emissions</span>
pmd &lt;-<span class="st"> </span><span class="kw">emis</span>(<span class="dt">veh =</span> lt, <span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> lefd, <span class="dt">speed =</span> speed,
            <span class="dt">profile =</span> profiles<span class="op">$</span>HGV_JUNE_<span class="dv">2014</span>)</code></pre></div>
<pre><code>## 32714.53 kg emissions in 24 hours and 7 days</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 4 process emissions</span>
<span class="co"># Agreggating emissions by age of use</span>
df &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> pmd, <span class="dt">MARGIN =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">FUN =</span> sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
euro</code></pre></div>
<pre><code>##  [1] &quot;V&quot;   &quot;IV&quot;  &quot;IV&quot;  &quot;IV&quot;  &quot;III&quot; &quot;III&quot; &quot;III&quot; &quot;III&quot; &quot;III&quot; &quot;III&quot; &quot;III&quot;
## [12] &quot;II&quot;  &quot;II&quot;  &quot;II&quot;  &quot;II&quot;  &quot;II&quot;  &quot;II&quot;  &quot;II&quot;  &quot;I&quot;   &quot;I&quot;   &quot;I&quot;   &quot;I&quot;  
## [23] &quot;I&quot;   &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot;
## [34] &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot;
## [45] &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot; &quot;PRE&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfbcom &lt;-<span class="st">   </span><span class="kw">rbind</span>(<span class="kw">speciate</span>(df[, <span class="dv">1</span>], <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>),
                  <span class="kw">speciate</span>(<span class="kw">rowSums</span>(df[, <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]), <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;IV&quot;</span>),
                  <span class="kw">speciate</span>(<span class="kw">rowSums</span>(df[, <span class="dv">5</span><span class="op">:</span><span class="dv">11</span>]), <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;III&quot;</span>),
                  <span class="kw">speciate</span>(<span class="kw">rowSums</span>(df[, <span class="dv">12</span><span class="op">:</span><span class="dv">18</span>]), <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;II&quot;</span>),
                  <span class="kw">speciate</span>(<span class="kw">rowSums</span>(df[, <span class="dv">19</span><span class="op">:</span><span class="dv">23</span>]), <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;I&quot;</span>),
                  <span class="kw">speciate</span>(<span class="kw">rowSums</span>(df[, <span class="dv">24</span><span class="op">:</span><span class="dv">50</span>]), <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;PRE&quot;</span>))
dfbcom<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">1505</span> 
bc &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dfbcom<span class="op">$</span>BC, <span class="dt">by =</span> <span class="kw">list</span>(dfbcom<span class="op">$</span>id), sum)
om &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dfbcom<span class="op">$</span>OM, <span class="dt">by =</span> <span class="kw">list</span>(dfbcom<span class="op">$</span>id), sum)
net<span class="op">$</span>BC &lt;-<span class="st"> </span>bc[, <span class="dv">2</span>]
net<span class="op">$</span>OM &lt;-<span class="st"> </span>om[, <span class="dv">2</span>]</code></pre></div>
<p>Now we have spatial objects of Back Carbon</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sp<span class="op">::</span><span class="kw">spplot</span>(net, <span class="st">&quot;BC&quot;</span>, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw =</span> T), <span class="dt">main =</span> <span class="st">&quot;Black Carbon [g/168h]&quot;</span>,
           <span class="dt">col.regions =</span> <span class="kw">rev</span>(cptcity<span class="op">::</span><span class="kw">cpt</span>()))</code></pre></div>
<div class="figure"><span id="fig:spplotbm"></span>
<img src="veinbook_files/figure-html/spplotbm-1.svg" alt="Black Carbon [g/168h]" width="672" />
<p class="caption">
Figure 8.1: Black Carbon [g/168h]
</p>
</div>
<p>and Organic Matter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sp<span class="op">::</span><span class="kw">spplot</span>(net, <span class="st">&quot;OM&quot;</span>, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw =</span> T), <span class="dt">main =</span> <span class="st">&quot;Organic Matter [g/168h]&quot;</span>,
           <span class="dt">col.regions =</span> <span class="kw">rev</span>(cptcity<span class="op">::</span><span class="kw">cpt</span>()))</code></pre></div>
<div class="figure"><span id="fig:spplotom"></span>
<img src="veinbook_files/figure-html/spplotom-1.svg" alt="Organic Matter [g/168h]" width="672" />
<p class="caption">
Figure 8.2: Organic Matter [g/168h]
</p>
</div>
<p>If you are interested in speciate total emissions by age of use not spatial emissions, you could use <code>emis_post</code> with <code>by = &quot;veh&quot;</code> and then aggregate the emissions by standard. Then speciate PM by standard:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfpm &lt;-<span class="st"> </span><span class="kw">emis_post</span>(<span class="dt">arra =</span> pmd,  <span class="dt">veh =</span> <span class="st">&quot;LT&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;small&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;D&quot;</span>,
                  <span class="dt">pollutant =</span> <span class="st">&quot;PM&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;veh&quot;</span>)
dfpm<span class="op">$</span>euro &lt;-<span class="st"> </span>euro
dfpmeuro &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dfpm<span class="op">$</span>g, <span class="dt">by =</span> <span class="kw">list</span>(dfpm<span class="op">$</span>euro), sum)
<span class="kw">names</span>(dfpmeuro) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;euro&quot;</span>, <span class="st">&quot;g&quot;</span>)
bcom &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="cf">function</span>(i){
  <span class="kw">speciate</span>(dfpmeuro<span class="op">$</span>g[i], <span class="st">&quot;bcom&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;D&quot;</span>, dfpmeuro<span class="op">$</span>euro[i])
}))
<span class="kw">names</span>(bcom) &lt;-<span class="st"> </span>dfpmeuro<span class="op">$</span>euro</code></pre></div>
<p>And the resulting speciation is:</p>
<table>
<caption><span id="tab:unnamed-chunk-96">Table 8.1: </span>Black Carbon and Organic Matter [g/168h]</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">I</th>
<th align="left">II</th>
<th align="left">III</th>
<th align="left">IV</th>
<th align="left">PRE</th>
<th align="left">V</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BC</td>
<td align="left">6826527.37503195</td>
<td align="left">5313757.92745243</td>
<td align="left">3321183.01325297</td>
<td align="left">155078.69338865</td>
<td align="left">6700527.80930883</td>
<td align="left">10369.2555188646</td>
</tr>
<tr class="even">
<td>OM</td>
<td align="left">2730610.95001278</td>
<td align="left">1222164.32331406</td>
<td align="left">498177.451987945</td>
<td align="left">20160.2301405245</td>
<td align="left">4690369.46651618</td>
<td align="left">20738.5110377293</td>
</tr>
</tbody>
</table>
</div>
<div id="tyre-wear-breaks-wear-and-road-abrassion" class="section level2">
<h2><span class="header-section-number">8.4</span> Tyre wear, breaks wear and road abrassion</h2>
<p>Tyre, break and road abrassions comes from <span class="citation">Ntziachristos and Boulter (<a href="#ref-NtziachristosBoulter2009">2009</a>)</span>. Tyres consist in a complex mixture of rubber, which after the use starts to degradate. In deed, when the driving cycle ismore aggresive, higher is tyre mass emitted from tyre, with tyre wear emission factors higher in HDV than LDV. Break wear emits mass and with more aggresive driving, more emissions.</p>
<p>The input are wear emissions in Total Suspended Particles (TSP) ,as explained in section @ref(#ew). The speciation consists in 60% PM10, 42% PM2.5, 6% PM1 and 4.8% PM0.1. Now, a simple example for TP adspeciation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
<span class="kw">data</span>(net)
<span class="kw">data</span>(profiles)
pro &lt;-<span class="st"> </span>profiles<span class="op">$</span>PC_JUNE_<span class="dv">2012</span>[, <span class="dv">1</span>] <span class="co"># 24 hours</span>
pc_week &lt;-<span class="st"> </span><span class="kw">temp_fact</span>(net<span class="op">$</span>ldv<span class="op">+</span>net<span class="op">$</span>hdv, pro)
df &lt;-<span class="st"> </span><span class="kw">netspeed</span>(pc_week, net<span class="op">$</span>ps, net<span class="op">$</span>ffs, net<span class="op">$</span>capacity, net<span class="op">$</span>lkm, <span class="dt">alpha =</span> <span class="dv">1</span>)
ef &lt;-<span class="st"> </span><span class="kw">ef_wear</span>(<span class="dt">wear =</span> <span class="st">&quot;tyre&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">speed =</span> df)
emit &lt;-<span class="st"> </span><span class="kw">emis_wear</span>(<span class="dt">veh =</span> <span class="kw">age_ldv</span>(net<span class="op">$</span>ldv, <span class="dt">name =</span> <span class="st">&quot;VEH&quot;</span>), <span class="dt">speed =</span> df,
                  <span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> ef, <span class="dt">profile =</span>  pro)</code></pre></div>
<pre><code>## Average age of VEH is 11.17</code></pre>
<pre><code>## Number of VEH is 1946.95 * 10^3 veh</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emib &lt;-<span class="st"> </span><span class="kw">emis_wear</span>(<span class="dt">what =</span> <span class="st">&quot;break&quot;</span>, <span class="dt">veh =</span> <span class="kw">age_ldv</span>(net<span class="op">$</span>ldv, <span class="dt">name =</span> <span class="st">&quot;VEH&quot;</span>),
                  <span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> ef, <span class="dt">profile =</span>  pro, <span class="dt">speed =</span> df)</code></pre></div>
<pre><code>## Average age of VEH is 11.17
## Number of VEH is 1946.95 * 10^3 veh</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emit</code></pre></div>
<pre><code>## This EmissionsArray has
##  1505 streets
##  50 vehicle categories
##  24 hours
##  1 days
## [1] 0.0499920404 0.0183982869 0.0026973699 0.0066891571 0.0002749512
## [6] 0.0212774028</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emib</code></pre></div>
<pre><code>## This EmissionsArray has
##  1505 streets
##  50 vehicle categories
##  24 hours
##  1 days
## [1] 0.0528581237 0.0153135442 0.0022451163 0.0070774117 0.0002288516
## [6] 0.0271699850</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emitp &lt;-<span class="st"> </span><span class="kw">emis_post</span>(<span class="dt">arra =</span> emit, <span class="dt">veh =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;ALL&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>,
                   <span class="dt">pollutant =</span> <span class="st">&quot;TSP&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;veh&quot;</span>)
emibp &lt;-<span class="st"> </span><span class="kw">emis_post</span>(<span class="dt">arra =</span> emib, <span class="dt">veh =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;ALL&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>,
                   <span class="dt">pollutant =</span> <span class="st">&quot;TSP&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;veh&quot;</span>)</code></pre></div>
<p>The estimation covered 24 hours and for simplicity, we are assuming a year with 365 similar days and dividing by 1 million to have t/y. Hence,the speciation is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
tyrew &lt;-<span class="st"> </span><span class="kw">speciate</span>(<span class="dt">x =</span>  <span class="kw">unclass</span>(emitp<span class="op">$</span>g), <span class="dt">spec =</span> <span class="st">&quot;tyre&quot;</span>)
breakw &lt;-<span class="st"> </span><span class="kw">speciate</span>(<span class="dt">x =</span>  <span class="kw">unclass</span>(emibp<span class="op">$</span>g), <span class="dt">spec =</span> <span class="st">&quot;brake&quot;</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Emis =</span> <span class="kw">c</span>(<span class="kw">sapply</span>(tyrew, sum), <span class="kw">sapply</span>(breakw, sum))<span class="op">*</span><span class="dv">365</span><span class="op">/</span><span class="dv">1000000</span>)
df<span class="op">$</span>Pollutant &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> <span class="kw">names</span>(tyrew), <span class="dt">levels =</span> <span class="kw">names</span>(tyrew))
df<span class="op">$</span>Emissions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Tyre&quot;</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">&quot;Brake&quot;</span>, <span class="dv">4</span>))
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> Pollutant, <span class="dt">y =</span> Emis, <span class="dt">fill =</span> Emissions)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&quot;[t/y]&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:styre"></span>
<img src="veinbook_files/figure-html/styre-1.svg" alt="Break and Tyre emissions (t/y)" width="672" />
<p class="caption">
Figure 8.3: Break and Tyre emissions (t/y)
</p>
</div>
<p>It is interesting to see that break emissions are higher than tyre wear emissions, and the smalle the diameter, higher the difference, as shows:</p>
<table>
<caption><span id="tab:unnamed-chunk-98">Table 8.2: </span>Ratio between break and tyre wear emissions</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PM10</td>
<td align="right">1.6593167</td>
</tr>
<tr class="even">
<td>PM2.5</td>
<td align="right">0.9433433</td>
</tr>
<tr class="odd">
<td>PM1</td>
<td align="right">1.6931803</td>
</tr>
<tr class="even">
<td>PM0.1</td>
<td align="right">1.6931803</td>
</tr>
</tbody>
</table>
<p>The procudure can be used with <code>emis_post</code> with <code>by  = streets_wide</code> to obtain the spatial speciation.</p>
</div>
<div id="no-and-no_2" class="section level2">
<h2><span class="header-section-number">8.5</span> <span class="math inline">\(NO\)</span> and <span class="math inline">\(NO_2\)</span></h2>
<p>The speciation of <span class="math inline">\(NO_X\)</span> into <span class="math inline">\(NO\)</span> and <span class="math inline">\(NO2\)</span> depends on the type of vehicle, fuel and euro standard. The following example will consists in comparing a Gasoline passenger car and a Diesel truck.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
<span class="kw">data</span>(net)
<span class="kw">data</span>(profiles)
propc &lt;-<span class="st"> </span>profiles<span class="op">$</span>PC_JUNE_<span class="dv">2012</span>[, <span class="dv">1</span>] <span class="co"># 24 hours</span>
prolt &lt;-<span class="st"> </span>profiles<span class="op">$</span>PC_JUNE_<span class="dv">2012</span>[, <span class="dv">1</span>] <span class="co"># 24 hours</span>
pweek &lt;-<span class="st"> </span><span class="kw">temp_fact</span>(net<span class="op">$</span>ldv<span class="op">+</span>net<span class="op">$</span>hdv, pro)
df &lt;-<span class="st"> </span><span class="kw">netspeed</span>(pc_week, net<span class="op">$</span>ps, net<span class="op">$</span>ffs, net<span class="op">$</span>capacity, net<span class="op">$</span>lkm, <span class="dt">alpha =</span> <span class="dv">1</span>)
euro &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;IV&quot;</span>, <span class="dv">3</span>),  
          <span class="kw">rep</span>(<span class="st">&quot;III&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;II&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;I&quot;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&quot;PRE&quot;</span>, <span class="dv">27</span>))
lefpc &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) {
  <span class="kw">ef_ldv_speed</span>(<span class="dt">v =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">t =</span> <span class="st">&quot;4S&quot;</span>, <span class="dt">cc =</span> <span class="st">&quot;&lt;=1400&quot;</span>, <span class="dt">f =</span> <span class="st">&quot;G&quot;</span>,
               <span class="dt">eu =</span> euro[i], <span class="dt">p =</span> <span class="st">&quot;NOx&quot;</span>, <span class="dt">show.equation =</span> <span class="ot">FALSE</span>) })
leflt &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) {
  <span class="kw">ef_hdv_speed</span>(<span class="dt">v =</span> <span class="st">&quot;Trucks&quot;</span>, <span class="dt">t =</span> <span class="st">&quot;RT&quot;</span>, <span class="dt">g =</span> <span class="st">&quot;&gt;32&quot;</span>, <span class="dt">gr =</span> <span class="dv">0</span>,
               <span class="dt">eu =</span> euro[i], <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">p =</span> <span class="st">&quot;NOx&quot;</span>, <span class="dt">show.equation =</span> <span class="ot">FALSE</span>) })
emipc &lt;-<span class="st"> </span><span class="kw">emis</span>(<span class="dt">veh =</span> <span class="kw">age_ldv</span>(net<span class="op">$</span>ldv),<span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> lefpc, <span class="dt">speed =</span> df,
              <span class="dt">profile =</span> profiles<span class="op">$</span>PC_JUNE_<span class="dv">2014</span>[, <span class="dv">1</span>])<span class="op">*</span><span class="dv">365</span><span class="op">/</span><span class="dv">1000000</span></code></pre></div>
<pre><code>## Average age of age is 11.17</code></pre>
<pre><code>## Number of age is 1946.95 * 10^3 veh</code></pre>
<pre><code>## 4097.62 kg emissions in 24 hours and 1 days</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emilt &lt;-<span class="st"> </span><span class="kw">emis</span>(<span class="dt">veh =</span> <span class="kw">age_ldv</span>(net<span class="op">$</span>hdv),<span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> leflt, <span class="dt">speed =</span> df,
              <span class="dt">profile =</span> profiles<span class="op">$</span>HGV_JUNE_<span class="dv">2014</span>[, <span class="dv">1</span>])<span class="op">*</span><span class="dv">365</span><span class="op">/</span><span class="dv">1000000</span></code></pre></div>
<pre><code>## Average age of age is 11.17</code></pre>
<pre><code>## Number of age is 148.12 * 10^3 veh</code></pre>
<pre><code>## 14612.67 kg emissions in 24 hours and 1 days</code></pre>
<p>Then, once the emissions are estimated, we will speciate the emissions by euro standard. The estimation covered 24 hours and for simplicity, we are assuming a year with 365 similar days and dividing by 1 million to have t/y.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">rowSums</span>(<span class="kw">apply</span>(<span class="dt">X =</span> emipc, <span class="dt">MARGIN =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">FUN =</span> sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
dfpc &lt;-<span class="st">   </span><span class="kw">rbind</span>(<span class="kw">speciate</span>(df[<span class="dv">1</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;V&quot;</span>),
                <span class="kw">speciate</span>(df[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;V&quot;</span>),
                <span class="kw">speciate</span>(df[<span class="dv">5</span><span class="op">:</span><span class="dv">11</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;V&quot;</span>),
                <span class="kw">speciate</span>(df[<span class="dv">12</span><span class="op">:</span><span class="dv">18</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;V&quot;</span>),
                <span class="kw">speciate</span>(df[<span class="dv">19</span><span class="op">:</span><span class="dv">23</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;V&quot;</span>),
                <span class="kw">speciate</span>(df[<span class="dv">24</span><span class="op">:</span><span class="dv">50</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;V&quot;</span>))
df &lt;-<span class="st"> </span><span class="kw">rowSums</span>(<span class="kw">apply</span>(<span class="dt">X =</span> emipc, <span class="dt">MARGIN =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">FUN =</span> sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
dfhdv &lt;-<span class="st">   </span><span class="kw">rbind</span>(<span class="kw">speciate</span>(df[<span class="dv">1</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;HDV&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>),
                 <span class="kw">speciate</span>(df[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;HDV&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>),
                 <span class="kw">speciate</span>(df[<span class="dv">5</span><span class="op">:</span><span class="dv">11</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;HDV&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>),
                 <span class="kw">speciate</span>(df[<span class="dv">12</span><span class="op">:</span><span class="dv">18</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;HDV&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>),
                 <span class="kw">speciate</span>(df[<span class="dv">19</span><span class="op">:</span><span class="dv">23</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;HDV&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>),
                 <span class="kw">speciate</span>(df[<span class="dv">24</span><span class="op">:</span><span class="dv">50</span>], <span class="st">&quot;nox&quot;</span>, <span class="st">&quot;HDV&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;V&quot;</span>))

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(<span class="kw">sapply</span>(dfpc, sum), <span class="kw">sapply</span>(dfhdv, sum)))
<span class="kw">row.names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PC&quot;</span>, <span class="st">&quot;HGV&quot;</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(df, <span class="dt">caption =</span> <span class="st">&quot;NO2 and NO speciation (t/y)&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:sno2">Table 8.3: </span>NO2 and NO speciation (t/y)</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">NO2</th>
<th align="right">NO</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PC</td>
<td align="right">44.8689</td>
<td align="right">1450.761</td>
</tr>
<tr class="even">
<td>HGV</td>
<td align="right">179.4756</td>
<td align="right">1316.154</td>
</tr>
</tbody>
</table>
</div>
<div id="volatile-organic-compounds-nmhc" class="section level2">
<h2><span class="header-section-number">8.6</span> Volatile organic compounds: <code>nmhc</code></h2>
<p>nmhc were shown earluier in this chapter, but they can be also used to speciate objects, resulting in all species at once. The speciation of NMHC must be applied to NMHC. However, the emission guidelines of <span class="citation">Ntziachristos and Samaras (<a href="#ref-NtziachristosSamaras2016">2016</a>)</span> does not show explicit emission factor of NMHC and the suggeted procedure is substract the <span class="math inline">\(CH_4\)</span> from the <span class="math inline">\(HC\)</span>. This was done on VEIN and now, ef_speed* functions returns NMHC directly. This makes easier to produce speciation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
<span class="kw">data</span>(net)
<span class="kw">data</span>(profiles)
propc &lt;-<span class="st"> </span>profiles<span class="op">$</span>PC_JUNE_<span class="dv">2012</span>[, <span class="dv">1</span>] <span class="co"># 24 hours</span>
pweek &lt;-<span class="st"> </span><span class="kw">temp_fact</span>(net<span class="op">$</span>ldv<span class="op">+</span>net<span class="op">$</span>hdv, propc)
df &lt;-<span class="st"> </span><span class="kw">netspeed</span>(pweek, net<span class="op">$</span>ps, net<span class="op">$</span>ffs, net<span class="op">$</span>capacity, net<span class="op">$</span>lkm, <span class="dt">alpha =</span> <span class="dv">1</span>)
euro &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;IV&quot;</span>, <span class="dv">3</span>),  
          <span class="kw">rep</span>(<span class="st">&quot;III&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;II&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;I&quot;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&quot;PRE&quot;</span>, <span class="dv">27</span>))
lefpc &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) {
  <span class="kw">ef_ldv_speed</span>(<span class="dt">v =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">t =</span> <span class="st">&quot;4S&quot;</span>, <span class="dt">cc =</span> <span class="st">&quot;&lt;=1400&quot;</span>, <span class="dt">f =</span> <span class="st">&quot;G&quot;</span>,
               <span class="dt">eu =</span> euro[i], <span class="dt">p =</span> <span class="st">&quot;NMHC&quot;</span>, <span class="dt">show.equation =</span> <span class="ot">FALSE</span>)})</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">euro &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;IV&quot;</span>, <span class="dv">3</span>),  
          <span class="kw">rep</span>(<span class="st">&quot;III&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;II&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;I&quot;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&quot;PRE&quot;</span>, <span class="dv">27</span>))
lefpc &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(euro), <span class="cf">function</span>(i) {
  <span class="kw">ef_ldv_speed</span>(<span class="dt">v =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">t =</span> <span class="st">&quot;4S&quot;</span>, <span class="dt">cc =</span> <span class="st">&quot;&lt;=1400&quot;</span>, <span class="dt">f =</span> <span class="st">&quot;G&quot;</span>,
               <span class="dt">eu =</span> euro[i], <span class="dt">p =</span> <span class="st">&quot;HC&quot;</span>, <span class="dt">show.equation =</span> <span class="ot">FALSE</span>) })
enmhc &lt;-<span class="st"> </span><span class="kw">emis</span>(<span class="dt">veh =</span> <span class="kw">age_ldv</span>(net<span class="op">$</span>ldv), <span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> lefpc, <span class="dt">speed =</span> df,
              <span class="dt">profile =</span> profiles<span class="op">$</span>PC_JUNE_<span class="dv">2014</span>[, <span class="dv">1</span>])</code></pre></div>
<pre><code>## Average age of age is 11.17</code></pre>
<pre><code>## Number of age is 1946.95 * 10^3 veh</code></pre>
<pre><code>## 3030.65 kg emissions in 24 hours and 1 days</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_enmhc &lt;-<span class="st"> </span><span class="kw">emis_post</span>(<span class="dt">arra =</span> enmhc, <span class="dt">veh =</span> <span class="st">&quot;PC&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;ALL&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>,
                      <span class="dt">pollutant =</span> <span class="st">&quot;NMHC&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;veh&quot;</span>)
<span class="co"># assuming all euro I</span>
spec &lt;-<span class="st"> </span><span class="kw">speciate</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(df_enmhc<span class="op">$</span>g), <span class="dt">spec =</span> <span class="st">&quot;nmhc&quot;</span>, <span class="dt">veh =</span> <span class="st">&quot;LDV&quot;</span>,
                 <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>, <span class="dt">eu =</span> <span class="st">&quot;I&quot;</span>)
<span class="kw">names</span>(spec)</code></pre></div>
<pre><code>##  [1] &quot;ethane&quot;                   &quot;propane&quot;                 
##  [3] &quot;butane&quot;                   &quot;isobutane&quot;               
##  [5] &quot;pentane&quot;                  &quot;isopentane&quot;              
##  [7] &quot;hexane&quot;                   &quot;heptane&quot;                 
##  [9] &quot;octane&quot;                   &quot;TWO_methylhexane&quot;        
## [11] &quot;nonane&quot;                   &quot;TWO_methylheptane&quot;       
## [13] &quot;THREE_methylhexane&quot;       &quot;decane&quot;                  
## [15] &quot;THREE_methylheptane&quot;      &quot;alcanes_C10_C12&quot;         
## [17] &quot;alkanes_C13&quot;              &quot;cycloalcanes&quot;            
## [19] &quot;ethylene&quot;                 &quot;propylene&quot;               
## [21] &quot;propadiene&quot;               &quot;ONE_butene&quot;              
## [23] &quot;isobutene&quot;                &quot;TWO_butene&quot;              
## [25] &quot;ONE_3_butadiene&quot;          &quot;ONE_pentene&quot;             
## [27] &quot;TWO_pentene&quot;              &quot;ONE_hexene&quot;              
## [29] &quot;dimethylhexene&quot;           &quot;ONE_butine&quot;              
## [31] &quot;propine&quot;                  &quot;acetylene&quot;               
## [33] &quot;formaldehyde&quot;             &quot;acetaldehyde&quot;            
## [35] &quot;acrolein&quot;                 &quot;benzaldehyde&quot;            
## [37] &quot;crotonaldehyde&quot;           &quot;methacrolein&quot;            
## [39] &quot;butyraldehyde&quot;            &quot;isobutanaldehyde&quot;        
## [41] &quot;propionaldehyde&quot;          &quot;hexanal&quot;                 
## [43] &quot;i_valeraldehyde&quot;          &quot;valeraldehyde&quot;           
## [45] &quot;o_tolualdehyde&quot;           &quot;m_tolualdehyde&quot;          
## [47] &quot;p_tolualdehyde&quot;           &quot;acetone&quot;                 
## [49] &quot;methylethlketone&quot;         &quot;toluene&quot;                 
## [51] &quot;ethylbenzene&quot;             &quot;m_p_xylene&quot;              
## [53] &quot;o_xylene&quot;                 &quot;ONE_2_3_trimethylbenzene&quot;
## [55] &quot;ONE_2_4_trimethylbenzene&quot; &quot;ONE_3_5_trimethylbenzene&quot;
## [57] &quot;styrene&quot;                  &quot;benzene&quot;                 
## [59] &quot;C9&quot;                       &quot;C10&quot;                     
## [61] &quot;C13&quot;</code></pre>
</div>
<div id="the-speciation-iag" class="section level2">
<h2><span class="header-section-number">8.7</span> The speciation <code>iag</code></h2>
<p>The Carbon Bond Mechanism Z <span class="citation">(<a href="#ref-cbmz">1999</a>)</span> is an lumped-structure mechanism.</p>
<p>Citing:</p>
<p>**“it is currently unfeasible to treat the organic species individually in a regional or global chemistry model for three major reasons:**</p>
<p><strong>- (1) limited computational resources,</strong> <strong>- (2) lack of detailed speciated emissions inventories, and </strong> <strong>- (3) lack of kinetic and mechanistic information for all the species and their reaction products.</strong></p>
<p><strong>Thus there exists a need for a condensed mechanism that is capable of describing the tropospheric hydrocarbon chemistry with reasonable accuracy, sensitivity, and speed at regional to global scales. </strong></p>
<p>The research in this aspect is intense and out of the scope of this book. However, it is important that the user who intends to performs atmospheric simulation to understand this why it is important to speciate the emissions and what represent each group.</p>
<p>A popular air quality model nowedays is the Weather Research and Forecasting model coupled to Chemistry (WRF-Chem) <span class="citation">(Grell et al. <a href="#ref-Grelletal2005">2005</a>)</span> <a href="https://ruc.noaa.gov/wrf/wrf-chem/and" class="uri">https://ruc.noaa.gov/wrf/wrf-chem/and</a> the <strong>Emissions Guide</strong> (<a href="https://ruc.noaa.gov/wrf/wrf-chem/Emission_guide.pdf" class="uri">https://ruc.noaa.gov/wrf/wrf-chem/Emission_guide.pdf</a>).</p>
<p>The speciation <code>iag</code> splits the NMHC into the lumped groups for the mechanism CMB-Z. The name <code>iag</code> comes from the Institute of Astronomy, Geophysics and Atmospheric Sciences (IAG, <a href="http://www.iag.usp.br/" class="uri">http://www.iag.usp.br/</a>) from the University of São Paulo (USP). The Departament of Atmospheric Sciences (DAC) of IAG has measure and model air quality models for several years. There are several scientific production such as: <span class="citation">Nogueira et al. (<a href="#ref-Nogueiraetal2015">2015</a>)</span>, <span class="citation">Hoshyaripour et al. (<a href="#ref-HOSHYARIPOUR2016365">2016</a>)</span>, <span class="citation">Andrade et al. (<a href="#ref-Andradeetal2017">2017</a>)</span>, <span class="citation">Freitas et al. (<a href="#ref-Freitasetal2005">2005</a>)</span>, <span class="citation">Martins et al. (<a href="#ref-martins2006emission">2006</a>)</span>, <span class="citation">Pérez-Martinez et al. (<a href="#ref-perez2014emission">2014</a>)</span>, <span class="citation">Ulke and Andrade (<a href="#ref-ulke2001modeling">2001</a>)</span>, <span class="citation">Vivanco and Fátima Andrade (<a href="#ref-vivanco2006validation">2006</a>)</span>, <span class="citation">Boian and Andrade (<a href="#ref-boian2012characterization">2012</a>)</span>, <span class="citation">Fatima Andrade et al. (<a href="#ref-Andrade2012">2012</a>)</span>, <span class="citation">Andrade et al. (<a href="#ref-Andradeetal2015">2015</a>)</span>, <span class="citation">Vara-Vela et al. (<a href="#ref-VaraVelaetal2015">2016</a>)</span>, <span class="citation">Rafee (<a href="#ref-Rafee2015">2015</a>)</span>, <span class="citation">S. Ibarra-Espinosa et al. (<a href="#ref-Ibarraetal2017b">2017</a>)</span>. The following figure, shows an air quality simulation over South Easth Brazil from DAC/IAG/USP.</p>
<div class="figure"><span id="fig:unnamed-chunk-102"></span>
<img src="figuras/wrf.png" alt="http://www.lapat.iag.usp.br/aerossol/wrf9/index.php" width="245" />
<p class="caption">
Figure 8.4: <a href="http://www.lapat.iag.usp.br/aerossol/wrf9/index.php" class="uri">http://www.lapat.iag.usp.br/aerossol/wrf9/index.php</a>
</p>
</div>
<p>Some of these papers show measurements in tunnels, fuel, etc. The speciation <code>iag</code> it is based on these experiments, and the last versions, covers an update during 2015 so that the exhaust emissions speciation is more representative of brazilian gasoline. This means that:</p>
<ul>
<li>** THE SPECIATION <code>IAG</code> IS BASED ON BRAZILIAN MEASUREMENTS**.</li>
</ul>
<p>and the user who wants to applt it outside Brazil, should be ensure, that the fleet and fuel are compatible. As that will be hard to accomplish, I can say that this speciation is for and to be used in Brazil, even more, in São Paulo.</p>
<p>The currently speciation <code>iag</code> is:</p>
<div class="figure"><span id="fig:unnamed-chunk-103"></span>
<img src="figuras/iag1.png" alt="Speciation for NMHC by type of fuel and process mol/100g (Ibarra-Espinosa, S., 2017)" width="445" />
<p class="caption">
Figure 8.5: Speciation for NMHC by type of fuel and process mol/100g (Ibarra-Espinosa, S., 2017)
</p>
</div>
<p>The arguments of the function <code>speciate</code> take the following form:</p>
<ul>
<li><code>x</code>: Emissions estimation, it is recommended that x are griddded emissions from NMHC.</li>
<li><code>spec</code>: <code>iag</code>. Alternatively, you can put any name of the following: “e_eth”, “e_hc3”, “e_hc5”, “e_hc8”, “e_ol2”, “e_olt”, “e_oli”, “e_iso”, “e_tol”, “e_xyl”, “e_c2h5oh”, “e_hcho”, “e_ch3oh”, “e_ket”</li>
<li><code>veh</code>: When spec is “iag” veh can take two values depending: when the speciation is for vehicles veh accepts “veh”, eu “Evaporative”, “Liquid” or “Exhaust”</li>
<li><code>fuel</code>: “G”, “E” or “D”.</li>
<li><code>eu</code>: “Exhaust” “Evaporative” or “Liquid”.</li>
<li><code>show</code>: Let this FALSE.</li>
<li><code>list</code>: Let this TRUE so that the result is a list, and each element of the list a lumped specie.</li>
</ul>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Do not run</span>
x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">400</span>, <span class="dt">sd =</span> <span class="dv">2</span>))
dfa &lt;-<span class="st"> </span><span class="kw">speciate</span>(x, <span class="dt">spec =</span> <span class="st">&quot;e_eth&quot;</span>, <span class="dt">veh =</span> <span class="st">&quot;veh&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>, <span class="dt">eu =</span> <span class="st">&quot;Exhaust&quot;</span>)
<span class="kw">head</span>(dfa)</code></pre></div>
<pre><code>##       e_eth
## 1 0.9292526
## 2 0.9278219
## 3 0.9241139
## 4 0.9247740
## 5 0.9290254
## 6 0.9248062</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">speciate</span>(x, <span class="dt">spec =</span> <span class="st">&quot;iag&quot;</span>, <span class="dt">veh =</span> <span class="st">&quot;veh&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>,
               <span class="dt">eu =</span> <span class="st">&quot;Exhaust&quot;</span>, <span class="dt">list =</span> <span class="ot">TRUE</span>)
<span class="kw">names</span>(df)</code></pre></div>
<pre><code>##  [1] &quot;e_eth&quot;    &quot;e_hc3&quot;    &quot;e_hc5&quot;    &quot;e_hc8&quot;    &quot;e_ol2&quot;    &quot;e_olt&quot;   
##  [7] &quot;e_oli&quot;    &quot;e_iso&quot;    &quot;e_tol&quot;    &quot;e_xyl&quot;    &quot;e_c2h5oh&quot; &quot;e_ald&quot;   
## [13] &quot;e_hcho&quot;   &quot;e_ch3oh&quot;  &quot;e_ket&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(df)){
  <span class="kw">print</span>(df[[i]][<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ]) <span class="co"># Firt three lines of each element of the list</span>
}</code></pre></div>
<pre><code>## Units: [mol/h]
## [1] 0.9292526 0.9278219 0.9241139
## Units: [mol/h]
## [1] 1.430927 1.428724 1.423014
## Units: [mol/h]
## [1] 0.5215303 0.5207273 0.5186462
## Units: [mol/h]
## [1] 0.2516515 0.2512641 0.2502599
## Units: [mol/h]
## [1] 1.909368 1.906428 1.898809
## Units: [mol/h]
## [1] 0.8004821 0.7992497 0.7960555
## Units: [mol/h]
## [1] 0.5306920 0.5298750 0.5277573
## Units: [mol/h]
## [1] 0.02545597 0.02541678 0.02531520
## Units: [mol/h]
## [1] 0.4619748 0.4612636 0.4594201
## Units: [mol/h]
## [1] 0.8801369 0.8787818 0.8752698
## Units: [mol/h]
## [1] 1.236292 1.234388 1.229455
## Units: [mol/h]
## [1] 0.3465503 0.3460168 0.3446339
## Units: [mol/h]
## [1] 0.4519747 0.4512789 0.4494753
## Units: [mol/h]
## [1] 0 0 0
## Units: [mol/h]
## [1] 0 0 0</code></pre>
</div>
<div id="the-speciation-pmiag" class="section level2">
<h2><span class="header-section-number">8.8</span> The speciation <code>pmiag</code></h2>
<p>The speciation <code>pmiag</code>is also based on IAG studies and applied only for PM2.5 emissions. The speciation splits the PM2.5 in percentages as follow:</p>
<table>
<caption><span id="tab:unnamed-chunk-105">Table 8.4: </span>Speciation of PM2.5</caption>
<thead>
<tr class="header">
<th align="right">E_SO4i</th>
<th align="right">E_SO4j</th>
<th align="right">E_NO3i</th>
<th align="right">E_NO3j</th>
<th align="right">E_MP2.5i</th>
<th align="right">E_MP2.5j</th>
<th align="right">E_ORGi</th>
<th align="right">E_ORGj</th>
<th align="right">E_ECi</th>
<th align="right">E_ECj</th>
<th align="right">H2O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0077</td>
<td align="right">0.0623</td>
<td align="right">0.00247</td>
<td align="right">0.01053</td>
<td align="right">0.1</td>
<td align="right">0.3</td>
<td align="right">0.0304</td>
<td align="right">0.1296</td>
<td align="right">0.056</td>
<td align="right">0.024</td>
<td align="right">0.277</td>
</tr>
</tbody>
</table>
<p>When running this speciation, the only two required arguments are <code>x</code> and <code>spec</code>. Also, There is a message that this speciation applies <strong>only in gridded emissions, because the unit must be in flux <span class="math inline">\(g/km^2/h\)</span></strong>, and internally are transformed to the required unit $ g/m^2/s$ as:</p>
<p><span class="math display">\[ \frac{g}{(km)^2*h}*\frac{10^6 \mu g}{g}*(\frac{km}{1000m})^2*\frac{h}{3600s}\frac{1}{dx^2}\]</span></p>
<p>dx is the length of the grid cell. Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vein)
<span class="kw">data</span>(net)
pm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pm =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">length</span>(net), <span class="dt">mean =</span> <span class="dv">400</span>, <span class="dt">sd =</span> <span class="dv">2</span>))
net<span class="op">@</span>data &lt;-<span class="st"> </span>pm
g &lt;-<span class="st"> </span><span class="kw">make_grid</span>(net, <span class="dv">1</span><span class="op">/</span><span class="fl">102.47</span><span class="op">/</span><span class="dv">2</span>) <span class="co"># 500 m</span></code></pre></div>
<pre><code>## Number of lon points: 23
## Number of lat points: 19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gx &lt;-<span class="st"> </span><span class="kw">emis_grid</span>(net, g)</code></pre></div>
<pre><code>## Sum of street emissions 601791.98</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersection assumes that they are planar</code></pre>
<pre><code>## Sum of gridded emissions 601791.98</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">speciate</span>(gx, <span class="dt">spec =</span> <span class="st">&quot;pmiag&quot;</span>, <span class="dt">veh =</span> <span class="st">&quot;veh&quot;</span>, <span class="dt">fuel =</span> <span class="st">&quot;G&quot;</span>,
               <span class="dt">eu =</span> <span class="st">&quot;Exhaust&quot;</span>, <span class="dt">list =</span> <span class="ot">FALSE</span>, <span class="dt">dx =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## To be used in emissions grid only, emissions must be in g/(Xkm^2)/h</code></pre>
<pre><code>## PM.2.5-10 must be calculated as substraction of PM10-PM2.5 to enter this variable into WRF</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df)</code></pre></div>
<pre><code>##  [1] &quot;e_so4i&quot;   &quot;e_so4j&quot;   &quot;e_no3i&quot;   &quot;e_no3j&quot;   &quot;e_pm2.5i&quot; &quot;e_pm2.5j&quot;
##  [7] &quot;e_orgi&quot;   &quot;e_orgj&quot;   &quot;e_eci&quot;    &quot;e_ecj&quot;    &quot;h2o&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df)</code></pre></div>
<pre><code>##                  e_so4i     e_so4j       e_no3i      e_no3j   e_pm2.5i
## 1 0.001452676 [g/m^2/s] 0.01175347 0.0004659882 0.001986581 0.01886592
## 2 0.001443911 [g/m^2/s] 0.01168255 0.0004631766 0.001974595 0.01875209
## 3 0.001480059 [g/m^2/s] 0.01197502 0.0004747721 0.002024028 0.01922154
## 4 0.002553385 [g/m^2/s] 0.02065921 0.0008190729 0.003491837 0.03316085
## 5 0.005770186 [g/m^2/s] 0.04668605 0.0018509557 0.007890917 0.07493748
## 6 0.000000000 [g/m^2/s] 0.00000000 0.0000000000 0.000000000 0.00000000
##     e_pm2.5j      e_orgi     e_orgj      e_eci       e_ecj        h2o
## 1 0.05659775 0.005735239 0.02445023 0.01056491 0.004527820 0.05225859
## 2 0.05625626 0.005700635 0.02430271 0.01050117 0.004500501 0.05194328
## 3 0.05766463 0.005843349 0.02491112 0.01076406 0.004613170 0.05324367
## 4 0.09948254 0.010080897 0.04297646 0.01857007 0.007958603 0.09185554
## 5 0.22481244 0.022780994 0.09711897 0.04196499 0.017984995 0.20757682
## 6 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.00000000</code></pre>

</div>
</div>
<h3>Appendix B</h3>
<div id="refs" class="references">
<div id="ref-NtziachristosSamaras2016">
<p>Ntziachristos, L, and Z Samaras. 2016. “EMEP/Eea Emission Inventory Guidebook; Road Transport: Passenger Cars, Light Commercial Trucks, Heavy-Duty Vehicles Including Buses and Motorcycles.” <em>European Environment Agency, Copenhagen</em>.</p>
</div>
<div id="ref-NtziachristosBoulter2009">
<p>Ntziachristos, L, and P Boulter. 2009. “EMEP/Eea Emission Inventory Guidebook; Road Transport: Automobile Tyre and Break Wear and Road Abrasion.” <em>European Environment Agency, Copenhagen</em>.</p>
</div>
<div id="ref-cbmz">
<p>Zaveri, Rahul A, and Leonard K Peters. 1999. “A New Lumped Structure Photochemical Mechanism for Large-Scale Applications.” <em>Journal of Geophysical Research: Atmospheres</em> 104 (D23). Wiley Online Library: 30387–30415.</p>
</div>
<div id="ref-Grelletal2005">
<p>Grell, Georg A, Steven E Peckham, Rainer Schmitz, Stuart A McKeen, Gregory Frost, William C Skamarock, and Brian Eder. 2005. “Fully Coupled ‘Online’ Chemistry Within the Wrf Model.” <em>Atmospheric Environment</em> 39 (37). Elsevier: 6957–75.</p>
</div>
<div id="ref-Nogueiraetal2015">
<p>Nogueira, Thiago, Kely Ferreira de Souza, Adalgiza Fornaro, Maria de Fatima Andrade, and Lilian Rothschild Franco de Carvalho. 2015. “On-Road Emissions of Carbonyls from Vehicles Powered by Biofuel Blends in Traffic Tunnels in the Metropolitan Area of Sao Paulo, Brazil.” <em>Atmospheric Environment</em> 108. Pergamon: 88–97.</p>
</div>
<div id="ref-HOSHYARIPOUR2016365">
<p>Hoshyaripour, G., G. Brasseur, M.F. Andrade, M. Gavidia-Calderón, I. Bouarar, and R.Y. Ynoue. 2016. “Prediction of Ground-Level Ozone Concentration in São Paulo, Brazil: Deterministic Versus Statistic Models.” <em>Atmospheric Environment</em> 145: 365–75. doi:<a href="https://doi.org/http://dx.doi.org/10.1016/j.atmosenv.2016.09.061">http://dx.doi.org/10.1016/j.atmosenv.2016.09.061</a>.</p>
</div>
<div id="ref-Andradeetal2017">
<p>Andrade, Maria de Fatima, Prashant Kumar, Edmilson Dias de Freitas, Rita Yuri Ynoue, Jorge Martins, Leila D Martins, Thiago Nogueira, et al. 2017. “Air Quality in the Megacity of São Paulo: Evolution over the Last 30 Years and Future Perspectives.” <em>Atmospheric Environment</em> 159. Elsevier: 66–82. doi:<a href="https://doi.org/https://doi.org/10.1016/j.atmosenv.2017.03.051">https://doi.org/10.1016/j.atmosenv.2017.03.051</a>.</p>
</div>
<div id="ref-Freitasetal2005">
<p>Freitas, Edmilson, Leila Martins, Pedro Silva Dias, and María de Fátima Andrade. 2005. “A Simple Photochemical Module Implemented in Rams for Tropospheric Ozone Concentration Forecast in the Metropolitan Area of São Paulo, Brazil: Coupling and Validation.” <em>Atmospheric Environment</em>, no. 39. Elsevier: 6352–61.</p>
</div>
<div id="ref-martins2006emission">
<p>Martins, Leila D, Maria F Andrade, Edmilson D Freitas, Angelica Pretto, Luciana V Gatti, Édler L Albuquerque, Edson Tomaz, Maria L Guardani, Maria HRB Martins, and Olimpio MA Junior. 2006. “Emission Factors for Gas-Powered Vehicles Traveling Through Road Tunnels in São Paulo, Brazil.” <em>Environ. Sci. Technol.</em> 40 (21). ACS Publications: 6722–9. doi:<a href="https://doi.org/10.1021/es052441u">10.1021/es052441u</a>.</p>
</div>
<div id="ref-perez2014emission">
<p>Pérez-Martinez, PJ, RM Miranda, T Nogueira, ML Guardani, A Fornaro, R Ynoue, and MF Andrade. 2014. “Emission Factors of Air Pollutants from Vehicles Measured Inside Road Tunnels in S  ao Paulo: Case Study Comparison.” <em>Int. J. Environ. Sci. Te.</em> 11 (8). Springer: 2155–68.</p>
</div>
<div id="ref-ulke2001modeling">
<p>Ulke, Ana G, and M Fátima Andrade. 2001. “Modeling Urban Air Pollution in Sao Paulo, Brazil: Sensitivity of Model Predicted Concentrations to Different Turbulence Parameterizations.” <em>Atmospheric Environment</em> 35 (10). Elsevier: 1747–63.</p>
</div>
<div id="ref-vivanco2006validation">
<p>Vivanco, Marta G, and Maria de Fátima Andrade. 2006. “Validation of the Emission Inventory in the Sao Paulo Metropolitan Area of Brazil, Based on Ambient Concentrations Ratios of Co, Nmog and Nox and on a Photochemical Model.” <em>Atmospheric Environment</em> 40 (7). Elsevier: 1189–98.</p>
</div>
<div id="ref-boian2012characterization">
<p>Boian, Cláudia, and Maria de Fátima Andrade. 2012. “Characterization of Ozone Transport Among Metropolitan Regions.” <em>Revista Brasileira de Meteorologia</em> 27 (2). SciELO Brasil: 229–42.</p>
</div>
<div id="ref-Andrade2012">
<p>Fatima Andrade, Maria de, Regina Maura de Miranda, Adalgiza Fornaro, Americo Kerr, Beatriz Oyama, Paulo Afonso de Andre, and Paulo Saldiva. 2012. “Vehicle Emissions and Pm2. 5 Mass Concentrations in Six Brazilian Cities.” <em>Air Quality, Atmosphere &amp; Health</em> 5 (1). Springer: 79–88.</p>
</div>
<div id="ref-Andradeetal2015">
<p>Andrade, Maria de Fatima, Rita Y Ynoue, Edmilson Dias Freitas, Enzo Todesco, Angel Vara Vela, Sergio Ibarra, Leila Droprinchinski Martins, Jorge Alberto Martins, and Vanessa Silveira Barreto Carvalho. 2015. “Air Quality Forecasting System for Southeastern Brazil.” <em>Frontiers in Environmental Science</em> 3. Frontiers: 1–12. doi:<a href="https://doi.org/10.3389/fenvs.2015.00009">10.3389/fenvs.2015.00009</a>.</p>
</div>
<div id="ref-VaraVelaetal2015">
<p>Vara-Vela, A., M. F. Andrade, P. Kumar, R. Y. Ynoue, and A. G. Muñoz. 2016. “Impact of Vehicular Emissions on the Formation of Fine Particles in the São Paulo Metropolitan Area: A Numerical Study with the Wrf-Chem Model.” <em>Atmos. Chem. and Phys.</em> 16: 777–97. doi:<a href="https://doi.org/10.5194/acp-16-777-2016">10.5194/acp-16-777-2016</a>.</p>
</div>
<div id="ref-Rafee2015">
<p>Rafee, S. A. A. 2015. “Estudo Numerico Do Impacto Das Emissões Veiculares E Fixas Da Cidade de Manaus Nas Concentrações de Poluentes Atmosféricos Da Região Amazônica.” PhD thesis, Londrina: Universidade Tecnologica Federal do Parana.</p>
</div>
<div id="ref-Ibarraetal2017b">
<p>Ibarra-Espinosa, S., R. Ynoue, S. O’Sullivan, E. Pebesma, M. D. F. Andrade, and M. Osses. 2017. “VEIN V0.2.2: An R Package for Bottom-up Vehicular Emissions Inventories.” <em>Geoscientific Model Development Discussions</em> 2017: 1–29. doi:<a href="https://doi.org/10.5194/gmd-2017-193">10.5194/gmd-2017-193</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="post.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ep.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ibarraespinosa/VEINBOOK/edit/master/inst/examples/08-speciate.Rmd",
"text": "Edit"
},
"download": ["veinbook.pdf", "veinbook.epub", "veinbook.mobi"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
